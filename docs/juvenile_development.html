<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Juvenile development time</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"> </a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="juvenile_development.html">Development</a>
</li>
<li>
  <a href="resistance.html">Resistance</a>
</li>
<li>
  <a href="respirometry.html">Respirometry</a>
</li>
<li>
  <a href="metabolites.html">Metabolites</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lukeholman/exp_evol_respiration">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Juvenile development time</h1>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-10-05
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>exp_evol_respiration/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20190703code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20190703)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20190703code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20190703)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomlukeholmanexpevolrespirationtree1c2e52c92c2f8db45fbfb28ee9fe4ba543b13f38targetblank1c2e52ca"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/lukeholman/exp_evol_respiration/tree/1c2e52c92c2f8db45fbfb28ee9fe4ba543b13f38" target="_blank">1c2e52c</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomlukeholmanexpevolrespirationtree1c2e52c92c2f8db45fbfb28ee9fe4ba543b13f38targetblank1c2e52ca" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/lukeholman/exp_evol_respiration/tree/1c2e52c92c2f8db45fbfb28ee9fe4ba543b13f38" target="_blank">1c2e52c</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    data/.DS_Store
    Ignored:    figures/.DS_Store
    Ignored:    output/.DS_Store

Untracked files:
    Untracked:  data/1.eclosion_wide.csv
    Untracked:  data/2.DesRes.csv
    Untracked:  data/2.StarvRes.csv
    Untracked:  data/3.metabolic_rates.csv
    Untracked:  data/4.metabolite_data.csv
    Untracked:  figures/desiccation.pdf
    Untracked:  figures/eclosion.pdf
    Untracked:  figures/eclosion_interaction_plot.pdf
    Untracked:  figures/metaboliteDAG.pdf
    Untracked:  figures/metabolite_plotCONTROLLED.pdf
    Untracked:  figures/metabolite_plotCONTROLLED_nolines.pdf
    Untracked:  figures/metabolite_plot_nolines.pdf
    Untracked:  figures/metabolites_supp.pdf
    Untracked:  figures/respirationDAG.pdf
    Untracked:  figures/respiration_figure_cycleI.pdf
    Untracked:  figures/respiration_figure_cycleI_inkscape.pdf
    Untracked:  figures/respiration_figure_noRQ.pdf
    Untracked:  figures/starvation.pdf
    Untracked:  output/brms_SEM_respiration_noslope.rds
    Untracked:  output/brms_metabolite_SEM_noslope.rds
    Untracked:  output/cox_brms_noslope.rds
    Untracked:  output/des_brm_noslope.rds
    Untracked:  output/metabolite_SEM_table.csv
    Untracked:  output/respirometry_SEM_table.csv
    Untracked:  output/sta_brm_noslope.rds
    Untracked:  output/stress_medians.csv
    Untracked:  output/wing_brms_noslope.rds

Unstaged changes:
    Modified:   analysis/metabolites.Rmd
    Deleted:    data/1.eclosion_times.csv
    Deleted:    data/2.metabolic_rates.csv
    Deleted:    data/3.DesRes.csv
    Deleted:    data/3.StarvRes.csv
    Deleted:    data/3.metabolite_data.csv
    Modified:   figures/metabolite_interaction_plot.pdf
    Modified:   figures/metabolite_pairs_plot.pdf
    Modified:   figures/metabolite_plot.pdf
    Modified:   figures/respiration_figure.pdf
    Modified:   figures/respiration_pairs_plot.pdf
    Modified:   output/cox_brms.rds
    Deleted:    output/coxmod.rds
    Deleted:    output/coxmod_dropINT.rds
    Deleted:    output/coxmod_dropSEX.rds
    Deleted:    output/coxmod_dropTRT.rds

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/juvenile_development.Rmd</code>) and HTML (<code>docs/juvenile_development.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/1c2e52c92c2f8db45fbfb28ee9fe4ba543b13f38/analysis/juvenile_development.Rmd" target="_blank">1c2e52c</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-10-05
</td>
<td>
wflow_publish(c(“analysis/index.Rmd”, “analysis/juvenile_development.Rmd”,
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/151e6fb225a2326a9de0e1239ad5b69a739c52cd/docs/juvenile_development.html" target="_blank">151e6fb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-23
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/juvenile_development.html" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/f7b49ff83b491eb6b5b39da55d82c972f2d798a0/analysis/juvenile_development.Rmd" target="_blank">f7b49ff</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
<td>
wflow_publish(c(“analysis/juvenile_development.Rmd”, “analysis/resistance.Rmd”,
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/ffb09ddd62fccb7ff88e77136354a02b73ff3fc8/docs/juvenile_development.html" target="_blank">ffb09dd</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-02-08
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/1b920460cfbb2f444fec0001dbbc9136f42d63ed/analysis/juvenile_development.Rmd" target="_blank">1b92046</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-02-08
</td>
<td>
wflow_publish(c(“analysis/juvenile_development.Rmd”, “analysis/resistance.Rmd”,
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/ae3c04ba0b0371db17c177f719f5e61fde03eefd/docs/juvenile_development.html" target="_blank">ae3c04b</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-02-06
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/25528a3aee0e9e421f26a86ecf0e725ba26503b2/analysis/juvenile_development.Rmd" target="_blank">25528a3</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-02-06
</td>
<td>
wflow_publish(“analysis/juvenile_development.Rmd”)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/709456c95d21a3528ad4dfa46afbe700888ef4ce/docs/juvenile_development.html" target="_blank">709456c</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2021-01-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/c2d846fc2a9cc72bfee6123cd5f65bd48d73cd6a/analysis/juvenile_development.Rmd" target="_blank">c2d846f</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2021-01-18
</td>
<td>
wflow_publish(c(“analysis/juvenile_development.Rmd”, “analysis/resistance.Rmd”,
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/d19a7e6d9c6d589c412de5ad306b10f834c9a019/docs/juvenile_development.html" target="_blank">d19a7e6</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/a0c557c726e08887acd0aefbd40aa42cffec1805/analysis/juvenile_development.Rmd" target="_blank">a0c557c</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
new title
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/41d232fe50f2e2d81eacb9efecc0f81170f8775f/docs/juvenile_development.html" target="_blank">41d232f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/68611151d7965e90de3dac3d1d5b0a29d2e4de9b/docs/juvenile_development.html" target="_blank">6861115</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/0d5bcc951f100a27ab74393063a546d55dd75d78/docs/juvenile_development.html" target="_blank">0d5bcc9</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/989e86ff1733879de61f286d01a7386021a6a84d/docs/juvenile_development.html" target="_blank">989e86f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/5a81a83900402b4b0191d283ee92cf111c926090/analysis/juvenile_development.Rmd" target="_blank">5a81a83</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
new menu
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/96d1188439aa0c873595bff6ae718123224f28df/analysis/juvenile_development.Rmd" target="_blank">96d1188</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-13
</td>
<td>
MDG commit
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/96d1188439aa0c873595bff6ae718123224f28df/docs/juvenile_development.html" target="_blank">96d1188</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-13
</td>
<td>
MDG commit
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/7d4b609075052dc7e107bda649d7ffd41e36ce84/analysis/juvenile_development.Rmd" target="_blank">7d4b609</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-05
</td>
<td>
MDG commit
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/7d4b609075052dc7e107bda649d7ffd41e36ce84/docs/juvenile_development.html" target="_blank">7d4b609</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-05
</td>
<td>
MDG commit
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/df61ddee93bc42f59613ae416f7a00684388bf71/docs/juvenile_development.html" target="_blank">df61dde</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-04
</td>
<td>
MDG commit
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/0714753f14aaca135e32ad4f585928f0f4fb0f55/analysis/juvenile_development.Rmd" target="_blank">0714753</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-04
</td>
<td>
workflowr::wflow_git_commit(all = T)
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/3fdbcb2298a2ba799632cade777d185e30eb9ec0/analysis/juvenile_development.Rmd" target="_blank">3fdbcb2</a>
</td>
<td>
lukeholman
</td>
<td>
2020-11-30
</td>
<td>
Tweaks Nov 2020
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="load-packages" class="section level2">
<h2>Load packages</h2>
<pre class="r"><code>library(tidyverse)
library(ggridges)

library(coxme)
library(brms)
library(tidybayes)

library(kableExtra)
library(knitrhooks) # install with devtools::install_github(&quot;nathaneastwood/knitrhooks&quot;)
library(showtext)

output_max_height() # a knitrhook option

options(stringsAsFactors = FALSE)

# set up nice font for figure
nice_font &lt;- &quot;Lora&quot;
font_add_google(name = nice_font, family = nice_font, regular.wt = 400, bold.wt = 700)
showtext_auto()</code></pre>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<pre class="r"><code># load eclosion data
eclosion_wide &lt;- read.csv(&quot;data/1.eclosion_wide.csv&quot;)

# convert data to &#39;long&#39; format
eclosion_long &lt;- reshape2::melt(eclosion_wide, id.vars = &quot;DAY&quot;)

# add ID columns
eclosion_long$YEAR &lt;- factor(&quot;2015&quot;)
eclosion_long$variable &lt;- paste(eclosion_long$variable, eclosion_long$YEAR, sep = &quot;_&quot;)
eclosion_long$ID &lt;- gsub(pattern = &quot;_m|f_&quot;, replacement = &quot;&quot;, x = eclosion_long$variable)

# calculate days to eclosion starting from seeding day
eclosion_long &lt;- eclosion_long %&gt;% 
  separate(variable, c(&quot;LINE&quot;, &quot;SEED&quot;, &quot;VIAL&quot;, &quot;SEX&quot;, &quot;YEAR&quot;)) %&gt;% 
  mutate(SEED_DAY = case_when(SEED == &#39;A&#39; ~ &quot;2015-7-20&quot;, 
                              SEED == &#39;B&#39; ~ &quot;2015-7-21&quot;,
                              SEED == &#39;C&#39; ~ &quot;2015-7-22&quot;),
         START_DAY = case_when(SEED == &#39;A&#39; ~ &quot;2015-8-01&quot;, 
                               SEED == &#39;B&#39; ~ &quot;2015-8-02&quot;,
                               SEED == &quot;C&quot; &amp; 
                                 LINE == &quot;M1&quot;| LINE == &quot;M2&quot;| LINE == &quot;M3&quot;| LINE == &quot;M4&quot; ~ &quot;2015-8-03&quot;,
                               TRUE ~ &quot;2015-8-04&quot;),
         DAY_ZERO = as.numeric(as.Date(START_DAY) - as.Date(SEED_DAY)),
         DAY = DAY + DAY_ZERO)


# remove rows where no flies eclosed
eclosion_long &lt;- subset(eclosion_long, value&gt;0)

# add event 
eclosion_long$EVENT &lt;- 1

# calulate number not eclosed for each vial (out of 100)
uneclosed &lt;- as.data.frame(eclosion_long %&gt;% 
                             group_by(ID, LINE, SEED, VIAL) %&gt;% 
                             summarise(SEX = &quot;fm&quot;,
                                       DAY = 21,
                                       eclosing = 100 - sum(value),
                                       EVENT = 0,
                                       YEAR = &quot;2015&quot;))


# calculate proportion eclosed of each sex to give weights to uneclosed
p &lt;- eclosion_long %&gt;% group_by(SEX) %&gt;% summarise(S = sum(value))
prop.male &lt;- p$S[2]/(p$S[2]+p$S[1])
prop.female &lt;- p$S[1]/(p$S[2]+p$S[1])

# assign sex to uneclosed in each vial based on those that have eclosed... i.e. slighly more females already eclosed
uneclosed.male &lt;- mutate(uneclosed, 
                            SEX = &quot;m&quot;, eclosing = round(uneclosed$eclosing*prop.female))

uneclosed.female &lt;- mutate(uneclosed, 
                              SEX = &quot;f&quot;, eclosing = round(uneclosed$eclosing*prop.male))

colnames(eclosion_long)[7] &lt;- &quot;eclosing&quot;

# reorder columns
eclosion_long &lt;- eclosion_long %&gt;% select(ID, DAY, SEX, LINE, SEED, VIAL, YEAR, eclosing, EVENT)

# bind eclosed data to calculated uneclosed
eclosion_long &lt;- rbind(eclosion_long, uneclosed.male, uneclosed.female)
eclosion_long &lt;- eclosion_long[order(eclosion_long$ID, eclosion_long$SEX), ]

# add treatment variable 
eclosion_long$TRT &lt;- factor(substr(eclosion_long$ID, 1, 1))

# remove vials seeded with more than 100 larvae
#unique(eclosion.dat[which(eclosion.dat$eclosing &lt; 0), &quot;ID&quot;]) # 4 vials overseeded
eclosion.dat.trim &lt;- eclosion_long %&gt;% 
  filter(ID %in% eclosion_long[which(eclosion_long$eclosing &lt; 0), &quot;ID&quot;] == FALSE)

# expand data frame so each row is a single fly
ecl.dat &lt;- reshape::untable(eclosion.dat.trim[ ,c(1:7, 9, 10)], 
                           num = eclosion.dat.trim[, 8])

# load wing length data
wing_length &lt;- read.csv(&quot;data/1.wing_length.csv&quot;) %&gt;% 
  filter(Side == &#39;L&#39;) %&gt;% 
  # scale wing vein length to make effect size comparisons with other data sets?
  mutate(Length = as.numeric(scale(Length)))

# add replicate
wing_length$LINE &lt;- paste0(wing_length$Treatment, substr(wing_length$Rep, 2, 2))</code></pre>
</div>
<div id="inspecting-the-raw-data" class="section level2">
<h2>Inspecting the raw data</h2>
<pre class="r"><code>ecl.dat %&gt;% 
  filter(EVENT == 1) %&gt;% 
  select(TRT, SEX, DAY) %&gt;% 
  mutate(TRT_SEX = paste0(TRT, SEX),
         SEX = factor(ifelse(SEX == &quot;m&quot;, &quot;Males&quot;, &quot;Females&quot;))) %&gt;% 
  ggplot(aes(x = DAY, y = SEX, fill = TRT_SEX)) +
  geom_boxplot() +
  scale_fill_manual(values = c(&quot;pink&quot;, &quot;skyblue&quot;, &quot;red&quot;, &quot;blue&quot;), name = &quot;&quot;,
                    labels = c(&#39;Monogamy Females&#39;, &#39;Monogamy Males&#39;,
                               &#39;Polandry Females&#39;, &#39;Polandry Males&#39;)) +
  labs(x = &#39;Eclosion time (days)&#39;, y = &#39;Sex&#39;) +
  theme_bw() +
  NULL</code></pre>
<p><img src="figure/juvenile_development.Rmd/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-1">
Past versions of unnamed-chunk-3-1.png
</button>
</p>
<div id="fig-unnamed-chunk-3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/figure/juvenile_development.Rmd/unnamed-chunk-3-1.png" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/ae3c04ba0b0371db17c177f719f5e61fde03eefd/docs/figure/juvenile_development.Rmd/unnamed-chunk-3-1.png" target="_blank">ae3c04b</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-02-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/709456c95d21a3528ad4dfa46afbe700888ef4ce/docs/figure/juvenile_development.Rmd/unnamed-chunk-3-1.png" target="_blank">709456c</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2021-01-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/989e86ff1733879de61f286d01a7386021a6a84d/docs/figure/juvenile_development.Rmd/unnamed-chunk-3-1.png" target="_blank">989e86f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/96d1188439aa0c873595bff6ae718123224f28df/docs/figure/juvenile_development.Rmd/unnamed-chunk-3-1.png" target="_blank">96d1188</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/df61ddee93bc42f59613ae416f7a00684388bf71/docs/figure/juvenile_development.Rmd/unnamed-chunk-3-1.png" target="_blank">df61dde</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="survival-analysis" class="section level1">
<h1>Survival analysis</h1>
<p>We modelled juvenile development time using survival analysis. We measured the time in days from 1st instar larvae until eclosion (<code>EVENT</code> = 1) upon which flies were stored in ethanol before counting. Of the initially seeded 100 flies per vial, the remaining flies not emerging after two consecutive days of no observed eclosions were right censored (<code>EVENT</code> = 0) on the last observation day. In total 14400 larvae were seeded (100 larvae x 2 <code>Treatment</code> x 4 <code>LINE</code> per <code>Treatment</code> x 6 <code>VIAL</code> per <code>LINE</code> x 3 <code>SEED</code> days). For P1 only three vials were seeded on day B so we seeded 3 additional vials on day C. Four vials were seeded with too many larvae and excluded from analysis. In total 10448 flies eclosed during the observation period leaving 3552 individuals to be right censored on day 9.</p>
<div id="censoring" class="section level3">
<h3>Censoring</h3>
<p>Censored flies were assigned sex based on the observed sex ratio of eclosees assuming an equal (50:50) sex ratio of larvae seeded to each vial at the beginning of the experiment. We calculate the number of number of males and females that did eclose and subsequently assign sex to the remaining (uneclosed) individuals of unknown sex based on the proportion of individuals of each sex that did emerge. For example, if 70 flies were counted eclosing from a vial with 40 females and 30 males, we then designate the remaining 30 flies as 10 females and 20 males and so on so that each vial ends with 50 females and 50 males some of which are right censored (<code>EVENT</code> = 0).</p>
</div>
<div id="kaplan-meier-survival-curve" class="section level3">
<h3>Kaplan-Meier survival curve</h3>
<p>First we plot Kaplan-Meier survival curves without considering our full experimental design.</p>
<pre class="r"><code>survminer::ggsurvplot(survfit(Surv(DAY, EVENT) ~ TRT + SEX, data = ecl.dat),
                      conf.int = TRUE,
                      risk.table = FALSE,
                      linetype = &quot;SEX&quot;,
                      palette = c(&quot;pink&quot;, &quot;skyblue&quot;, &quot;red&quot;, &quot;blue&quot;),
                      fun = &quot;event&quot;,
                      xlim = c(12, 21),
                      xlab = &quot;Days&quot;,
                      legend = &#39;right&#39;,
                      legend.title = &quot;&quot;,
                      legend.labs = c(&quot;M \u2640&quot;,&quot;M \u2642&quot;,&#39;E \u2640&#39;,&#39;E \u2642&#39;),
                      break.time.by = 2,
                      ggtheme = theme_bw())</code></pre>
<p><img src="figure/juvenile_development.Rmd/unnamed-chunk-4-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-1">
Past versions of unnamed-chunk-4-1.png
</button>
</p>
<div id="fig-unnamed-chunk-4-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/figure/juvenile_development.Rmd/unnamed-chunk-4-1.png" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/ae3c04ba0b0371db17c177f719f5e61fde03eefd/docs/figure/juvenile_development.Rmd/unnamed-chunk-4-1.png" target="_blank">ae3c04b</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-02-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/709456c95d21a3528ad4dfa46afbe700888ef4ce/docs/figure/juvenile_development.Rmd/unnamed-chunk-4-1.png" target="_blank">709456c</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2021-01-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/989e86ff1733879de61f286d01a7386021a6a84d/docs/figure/juvenile_development.Rmd/unnamed-chunk-4-1.png" target="_blank">989e86f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/96d1188439aa0c873595bff6ae718123224f28df/docs/figure/juvenile_development.Rmd/unnamed-chunk-4-1.png" target="_blank">96d1188</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/7d4b609075052dc7e107bda649d7ffd41e36ce84/docs/figure/juvenile_development.Rmd/unnamed-chunk-4-1.png" target="_blank">7d4b609</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/df61ddee93bc42f59613ae416f7a00684388bf71/docs/figure/juvenile_development.Rmd/unnamed-chunk-4-1.png" target="_blank">df61dde</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>#ggsave(filename = &#39;figures/eclosion.pdf&#39;, width = 5.5, height = 5, dpi = 600, useDingbats = FALSE)</code></pre>
<p><strong>Figure X:</strong> Kaplan-Meier curve for eclosion time (in days) for flies in each treatment and sex. +’s indicate censored individuals (n = 3552).</p>
</div>
<div id="median-eclosion-times" class="section level3">
<h3>Median eclosion times</h3>
<pre class="r"><code>summary(survfit(Surv(DAY, EVENT) ~ TRT + SEX, data = ecl.dat))$table %&gt;% 
  as_tibble() %&gt;% 
  mutate(Treatment = c(&#39;M&#39;, &#39;M&#39;, &#39;E&#39;, &#39;E&#39;),
         Sex = c(&#39;Female&#39;, &#39;Male&#39;, &#39;Female&#39;, &#39;Male&#39;)) %&gt;% 
  mutate(`Median (± 95% CI)` = paste0(median, &#39; (&#39;, `0.95LCL`, &#39;-&#39;, `0.95UCL`, &#39;)&#39;)) %&gt;% 
  dplyr::select(Treatment, Sex, N = records, `N events` = events, `Median (± 95% CI)`) %&gt;%
  kable() %&gt;% 
  kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Treatment
</th>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
N events
</th>
<th style="text-align:left;">
Median (± 95% CI)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
3637
</td>
<td style="text-align:right;">
3059
</td>
<td style="text-align:left;">
16 (16-16)
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
3363
</td>
<td style="text-align:right;">
2697
</td>
<td style="text-align:left;">
16 (16-16)
</td>
</tr>
<tr>
<td style="text-align:left;">
E
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
3568
</td>
<td style="text-align:right;">
2492
</td>
<td style="text-align:left;">
18 (18-18)
</td>
</tr>
<tr>
<td style="text-align:left;">
E
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
3432
</td>
<td style="text-align:right;">
2200
</td>
<td style="text-align:left;">
18 (18-18)
</td>
</tr>
</tbody>
</table>
</div>
<div id="check-proportional-hazards-assumption" class="section level3">
<h3>Check proportional hazards assumption</h3>
<p>Next we need to check that the proportional hazards assumption is not violated before fitting the model, where crossing hazards (lines) indicate violation of the proportional hazards assumption.</p>
<pre class="r"><code>survminer::ggsurvplot(survfit(Surv(DAY, EVENT) ~ TRT + SEX, data = ecl.dat),
                      conf.int = TRUE,
                      risk.table = FALSE,
                      linetype = &quot;SEX&quot;,
                      palette = c(&quot;pink&quot;, &quot;skyblue&quot;, &quot;red&quot;, &quot;blue&quot;),
                      fun = &quot;cloglog&quot;,
                      xlim = c(13, 21),
                      legend = &#39;right&#39;,
                      legend.title = &quot;&quot;,
                      legend.labs = c(&quot;M \u2640&quot;,&quot;M \u2642&quot;,&#39;E \u2640&#39;,&#39;E \u2642&#39;),
                      break.time.by = 2,
                      ggtheme = theme_bw())</code></pre>
<p><img src="figure/juvenile_development.Rmd/unnamed-chunk-6-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-1">
Past versions of unnamed-chunk-6-1.png
</button>
</p>
<div id="fig-unnamed-chunk-6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/figure/juvenile_development.Rmd/unnamed-chunk-6-1.png" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/709456c95d21a3528ad4dfa46afbe700888ef4ce/docs/figure/juvenile_development.Rmd/unnamed-chunk-6-1.png" target="_blank">709456c</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2021-01-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/989e86ff1733879de61f286d01a7386021a6a84d/docs/figure/juvenile_development.Rmd/unnamed-chunk-6-1.png" target="_blank">989e86f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/96d1188439aa0c873595bff6ae718123224f28df/docs/figure/juvenile_development.Rmd/unnamed-chunk-6-1.png" target="_blank">96d1188</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/7d4b609075052dc7e107bda649d7ffd41e36ce84/docs/figure/juvenile_development.Rmd/unnamed-chunk-6-1.png" target="_blank">7d4b609</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/df61ddee93bc42f59613ae416f7a00684388bf71/docs/figure/juvenile_development.Rmd/unnamed-chunk-6-1.png" target="_blank">df61dde</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Figure X:</strong> ln(-ln(survival))</p>
</div>
<div id="fit-the-model-in-brms" class="section level2">
<h2>Fit the model in <code>brms</code></h2>
<p>We fit a Cox Proportional hazards model in <code>brms</code> using <code>family = cox()</code>, with time (days) to event (eclosion) as the response and sexual selection treatment (<code>TRT</code>; Monogamy or Elevated polyandry), <code>SEX</code> (female or male) and their interaction as predictors with Seed day as a covariate. <a href="https://bookdown.org/content/4857/god-spiked-the-integers.html">See here</a> for a helpful explanation on fitting survival models in <code>brms</code>. We also include replicate treatment as a random intercept term for each of the 8 lines and a random slope term to allow the effect of selection treatment to vary across replicate lines. We also include vial <code>ID</code> as a random intercept term as individuals emerging from the same vial may show a correlated response.</p>
<div id="define-priors" class="section level4">
<h4>Define priors</h4>
<p>We set conservative normal priors on the fixed effects (mean = 0, sd = 1) and half Cauchy priors on the random effects - <code>LINE</code> and vial <code>ID</code> - (mean = 0, scale = 0.1). All other priors were left at the default in <code>brms</code>.</p>
</div>
<div id="run-the-model" class="section level4">
<h4>Run the model</h4>
<p>The model is run over 4 chains with 5000 iterations each (with the first 2500 discarded as burn-in), for a total of 2500*4 = 10,000 posterior samples. Note that some of the <code>brms</code> functionality is not currently available for models using the <code>cox</code> family (e.g. posterior predictive checks).</p>
<pre class="r"><code>if(!file.exists(&quot;output/cox_brms.rds&quot;)){
  
  cox_brm &lt;- brm(DAY | cens(1 - EVENT) ~ TRT * SEX + SEED + (TRT|LINE) + (1|ID),
               iter = 5000, chains = 4, cores = 4,
               prior = c(set_prior(&quot;normal(0,1)&quot;, class = &quot;b&quot;),
                         set_prior(&quot;cauchy(0,0.1)&quot;, class = &quot;sd&quot;)),
               control = list(max_treedepth = 20,
                              adapt_delta = 0.999),
               data = ecl.dat, family = cox())
  
  #saveRDS(cox_brm, &quot;output/cox_brms_noslope.rds&quot;) # save with no random slope term
  saveRDS(cox_brm, &quot;output/cox_brms.rds&quot;)
} else {
  cox_brm &lt;- readRDS(&#39;output/cox_brms_noslope.rds&#39;)
}</code></pre>
</div>
<div id="table-of-model-parameter-estimates---eclosion-time" class="section level3 tabset">
<h3 class="tabset">Table of model parameter estimates - eclosion time</h3>
<div id="formatted-table" class="section level4">
<h4>Formatted table</h4>
<p>This tables shows the fixed effects estimates on eclosion time. The p column shows 1 - minus the “probability of direction”, i.e. the posterior probability that the reported sign of the estimate is correct given the data and the prior; subtracting this value from one gives a Bayesian equivalent of a one-sided p-value. Click the next tab to see a complete summary of the model and its output.</p>
<pre class="r"><code>hyp_test &lt;- bind_rows(
  hypothesis(cox_brm, &#39;TRTP = 0&#39;)$hypothesis,
  hypothesis(cox_brm, &#39;SEXm = 0&#39;)$hypothesis,
  hypothesis(cox_brm, &#39;TRTP:SEXm = 0&#39;)$hypothesis,
  hypothesis(cox_brm, &#39;SEEDB = 0&#39;)$hypothesis,
  hypothesis(cox_brm, &#39;SEEDC = 0&#39;)$hypothesis
) %&gt;% 
  mutate(Parameter = c(&#39;Treatment (E)&#39;, &#39;Sex (M)&#39;, &#39;Treatment (E) x Sex (M)&#39;, &#39;Seed (B)&#39;, &#39;Seed (C)&#39;),
         across(2:5, round, 3)) %&gt;% 
  relocate(Parameter, Estimate, Est.Error, CI.Lower, CI.Upper, Star)

pvals &lt;- bayestestR::p_direction(cox_brm) %&gt;% 
  as.data.frame() %&gt;%
  mutate(vars = map_chr(str_split(Parameter, &quot;_&quot;), ~ .x[2]),
         p_val = 1 - pd, 
         star = ifelse(p_val &lt; 0.05, &quot;\\*&quot;, &quot;&quot;)) %&gt;%
  select(vars, p_val, star)

hyp_test %&gt;% 
  mutate(vars = c(&#39;TRTP&#39;, &#39;SEXm&#39;, &#39;TRTP:SEXm&#39;, &#39;SEEDB&#39;, &#39;SEEDC&#39;)) %&gt;% 
  left_join(pvals %&gt;% filter(vars != &#39;Intercept&#39;), 
            by = c(&quot;vars&quot;)) %&gt;% 
  select(Parameter, Estimate, Est.Error, CI.Lower, CI.Upper, `p` = p_val, star) %&gt;% 
  rename(` ` = star) %&gt;%
  mutate(p = ifelse(p &gt; 0.001, round(p, 3), &#39;&lt; 0.001&#39;)) %&gt;% 
  kable() %&gt;% 
  kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Est.Error
</th>
<th style="text-align:right;">
CI.Lower
</th>
<th style="text-align:right;">
CI.Upper
</th>
<th style="text-align:left;">
p
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Treatment (E)
</td>
<td style="text-align:right;">
-0.812
</td>
<td style="text-align:right;">
0.283
</td>
<td style="text-align:right;">
-1.341
</td>
<td style="text-align:right;">
-0.206
</td>
<td style="text-align:left;">
0.008
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex (M)
</td>
<td style="text-align:right;">
-0.175
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
-0.227
</td>
<td style="text-align:right;">
-0.124
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left;">
Treatment (E) x Sex (M)
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:right;">
0.040
</td>
<td style="text-align:right;">
-0.066
</td>
<td style="text-align:right;">
0.087
</td>
<td style="text-align:left;">
0.404
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Seed (B)
</td>
<td style="text-align:right;">
0.096
</td>
<td style="text-align:right;">
0.095
</td>
<td style="text-align:right;">
-0.091
</td>
<td style="text-align:right;">
0.282
</td>
<td style="text-align:left;">
0.152
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Seed (C)
</td>
<td style="text-align:right;">
0.342
</td>
<td style="text-align:right;">
0.091
</td>
<td style="text-align:right;">
0.165
</td>
<td style="text-align:right;">
0.521
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
<td style="text-align:left;">
*
</td>
</tr>
</tbody>
</table>
</div>
<div id="complete-output-from-summary.brmsfit" class="section level4">
<h4>Complete output from <code>summary.brmsfit()</code></h4>
<pre class="r"><code>cox_brm</code></pre>
<pre> Family: cox 
  Links: mu = log 
Formula: DAY | cens(1 - EVENT) ~ TRT * SEX + SEED + (1 | LINE) + (1 | ID) 
   Data: ecl.dat (Number of observations: 14000) 
  Draws: 4 chains, each with iter = 5000; warmup = 2500; thin = 1;
         total post-warmup draws = 10000

Group-Level Effects: 
~ID (Number of levels: 140) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.43      0.03     0.38     0.49 1.00     2350     4250

~LINE (Number of levels: 8) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.38      0.13     0.20     0.71 1.00     2850     4633

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.65      0.21     0.21     1.05 1.00     2982     3813
TRTP         -0.81      0.28    -1.34    -0.21 1.00     3212     3734
SEXm         -0.18      0.03    -0.23    -0.12 1.00     9274     7816
SEEDB         0.10      0.09    -0.09     0.28 1.00     1759     2830
SEEDC         0.34      0.09     0.16     0.52 1.00     1977     3613
TRTP:SEXm     0.01      0.04    -0.07     0.09 1.00     9097     7662

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).
</pre>
</div>
</div>
<div id="posterior-effect-size-of-treatment-on-eclosion-time-for-each-sex" class="section level3">
<h3>Posterior effect size of treatment on eclosion time for each sex</h3>
<p>As <code>posterior_eprid()</code> is not available for <code>brms</code> models using the <code>cox</code> family, we manually calculate the estimates for each group from the posterior predictions. The <span class="math inline">\(\beta\)</span> coefficients from a Cox model measure the impact of covariates and give an estimate of the effect size (<a href="http://www.sthda.com/english/wiki/cox-proportional-hazards-model">see here</a>). Taking the exponent of the coefficients give the hazard ratio. In short, hazard ratios give the probability of the event occurring compared to the ‘control’ group, in our case compared to Monogamy females, where:</p>
<ul>
<li>Hazard ratio = 1 (<span class="math inline">\(\beta\)</span> = 0): no effect</li>
<li>Hazard ratio &gt; 1 (<span class="math inline">\(\beta\)</span> &gt; 0): reduced hazard (higher probability of eclosion)</li>
<li>Hazard ratio &lt; 1 (<span class="math inline">\(\beta\)</span> &lt; 0): increased hazard (lower probability of eclosion)</li>
</ul>
<pre class="r"><code>treatsex_eclosion &lt;- posterior_samples(cox_brm) %&gt;% 
  as_tibble() %&gt;%
  select(starts_with(&quot;b_&quot;)) %&gt;% 
  mutate(draw = 1:n()) %&gt;% 
  mutate(M_f = b_Intercept,
         P_f = b_Intercept + b_TRTP,
         M_m = b_Intercept + b_SEXm,
         P_m = b_TRTP + b_SEXm + `b_TRTP:SEXm`) %&gt;% 
  select(draw, M_f, P_f, M_m, P_m) %&gt;% 
  pivot_longer(cols = 2:5) %&gt;% 
  mutate(SEX = str_sub(name, -1),
         TRT = str_sub(name, 1, 1)) %&gt;%
  select(draw, value, SEX, TRT) %&gt;% 
  pivot_wider(names_from = TRT,
              values_from = value) %&gt;%
  mutate(`Difference in means (Poly - Mono)` = P - M)

treatsex_eclosion %&gt;%
  ggplot(aes(x = SEX, y = `Difference in means (Poly - Mono)`, fill = SEX)) +
  geom_hline(yintercept = 0, linetype = 2) +
  stat_halfeye() + 
  scale_fill_brewer(palette = &#39;Pastel1&#39;, direction = 1, name = &quot;&quot;) +
  scale_colour_brewer(palette = &#39;Pastel1&#39;, direction = 1, name = &quot;&quot;) +
  labs(y = &#39;Difference in means (\u03b2) between\nselection treatments (E - M)&#39;) +
  theme_bw() +
  theme(legend.position = &#39;none&#39;,
        strip.background = element_blank(),
        panel.grid.major.x = element_blank()) +
  NULL</code></pre>
<p><img src="figure/juvenile_development.Rmd/unnamed-chunk-10-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-10-1">
Past versions of unnamed-chunk-10-1.png
</button>
</p>
<div id="fig-unnamed-chunk-10-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/figure/juvenile_development.Rmd/unnamed-chunk-10-1.png" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/989e86ff1733879de61f286d01a7386021a6a84d/docs/figure/juvenile_development.Rmd/unnamed-chunk-10-1.png" target="_blank">989e86f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/7d4b609075052dc7e107bda649d7ffd41e36ce84/docs/figure/juvenile_development.Rmd/unnamed-chunk-10-1.png" target="_blank">7d4b609</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/df61ddee93bc42f59613ae416f7a00684388bf71/docs/figure/juvenile_development.Rmd/unnamed-chunk-10-1.png" target="_blank">df61dde</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Figure X:</strong> Difference in mean <span class="math inline">\(\beta\)</span> coefficients for the survival analysis on eclosion time between the selection treatments (Elevated polyandry - Monogamy).</p>
</div>
</div>
<div id="posterior-difference-in-treatment-effect-size-between-sexes" class="section level2 tabset">
<h2 class="tabset">Posterior difference in treatment effect size between sexes</h2>
<p>This section examines the treatment <span class="math inline">\(\times\)</span> sex interaction term, by calculating the difference in the effect size of the E/M treatment between sexes. We find evidence for a treatment <span class="math inline">\(\times\)</span> sex interaction, i.e. the difference in eclosion time between the sexes was greater in the E treatment than the M treatment.</p>
<div id="figure" class="section level3">
<h3>Figure</h3>
<pre class="r"><code>treatsex_eclosion %&gt;%
  rename(d = `Difference in means (Poly - Mono)`) %&gt;% 
  select(draw, SEX, d) %&gt;%
  group_by(draw) %&gt;%
  summarise(`Difference in effect size between sexes (male - female)` = d[2] - d[1],
            .groups = &quot;drop&quot;) %&gt;% 
  ggplot(aes(x = `Difference in effect size between sexes (male - female)`, y = 1, fill = stat(x &lt; 0))) +
  geom_vline(xintercept = 0, linetype = 2) +
  stat_halfeye() +
  scale_fill_brewer(palette = &#39;Pastel2&#39;, direction = 1, name = &quot;&quot;) +
  theme_bw() +
  theme(legend.position = &#39;none&#39;,
        text = element_text(family = nice_font),
        strip.background = element_blank()) +
  ylab(&quot;Posterior density&quot;) +
  #ggsave(&quot;figures/eclosion_interaction_plot.pdf&quot;, height=4, width=6) +
  NULL</code></pre>
<p><img src="figure/juvenile_development.Rmd/unnamed-chunk-11-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-11-1">
Past versions of unnamed-chunk-11-1.png
</button>
</p>
<div id="fig-unnamed-chunk-11-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/figure/juvenile_development.Rmd/unnamed-chunk-11-1.png" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/709456c95d21a3528ad4dfa46afbe700888ef4ce/docs/figure/juvenile_development.Rmd/unnamed-chunk-11-1.png" target="_blank">709456c</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2021-01-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/989e86ff1733879de61f286d01a7386021a6a84d/docs/figure/juvenile_development.Rmd/unnamed-chunk-11-1.png" target="_blank">989e86f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/96d1188439aa0c873595bff6ae718123224f28df/docs/figure/juvenile_development.Rmd/unnamed-chunk-11-1.png" target="_blank">96d1188</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/7d4b609075052dc7e107bda649d7ffd41e36ce84/docs/figure/juvenile_development.Rmd/unnamed-chunk-11-1.png" target="_blank">7d4b609</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/df61ddee93bc42f59613ae416f7a00684388bf71/docs/figure/juvenile_development.Rmd/unnamed-chunk-11-1.png" target="_blank">df61dde</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-04
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="table" class="section level3">
<h3>Table</h3>
<pre class="r"><code>treatsex_interaction_eclosion &lt;- treatsex_eclosion %&gt;%
  select(draw, SEX, d =  `Difference in means (Poly - Mono)`) %&gt;%
  arrange(draw, SEX) %&gt;%
  group_by(draw) %&gt;%
  summarise(`Difference in effect size between sexes (male - female)` = d[2] - d[1],
            .groups = &quot;drop&quot;) # males - females

treatsex_interaction_eclosion %&gt;%
  rename(x = `Difference in effect size between sexes (male - female)`) %&gt;%
  summarise(`Difference in effect size between sexes (male - female)` = median(x),
            `Lower 95% CI` = quantile(x, probs = 0.025), 
            `Upper 95% CI` = quantile(x, probs = 0.975),
            p = 1 - as.numeric(bayestestR::p_direction(x)),
            ` ` = ifelse(p &lt; 0.05, &quot;\\*&quot;, &quot;&quot;),
            .groups = &quot;drop&quot;) %&gt;%
  kable(digits=3) %&gt;%
  kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Difference in effect size between sexes (male - female)
</th>
<th style="text-align:right;">
Lower 95% CI
</th>
<th style="text-align:right;">
Upper 95% CI
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.65
</td>
<td style="text-align:right;">
-1.049
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:left;">
*
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>sex_eclosion &lt;- posterior_samples(cox_brm) %&gt;% 
  as_tibble() %&gt;%
  select(starts_with(&quot;b_&quot;)) %&gt;% 
  mutate(draw = 1:n()) %&gt;% 
  mutate(M_f = b_Intercept,
         P_f = b_Intercept + b_TRTP,
         M_m = b_Intercept + b_SEXm,
         P_m = b_TRTP + b_SEXm + `b_TRTP:SEXm`) %&gt;% 
  select(draw, M_f, P_f, M_m, P_m) %&gt;% 
  pivot_longer(cols = 2:5) %&gt;% 
  mutate(SEX = str_sub(name, -1),
         TRT = str_sub(name, 1, 1)) %&gt;%
  select(draw, value, SEX, TRT) %&gt;% 
  pivot_wider(names_from = SEX,
              values_from = value) %&gt;%
  mutate(`Difference in means (Female - Male)` = f - m)

sex_eclosion %&gt;%
  ggplot(aes(x = TRT, y = `Difference in means (Female - Male)`, fill = TRT)) +
  geom_hline(yintercept = 0, linetype = 2) +
  stat_halfeye() + 
  scale_fill_brewer(palette = &#39;Pastel1&#39;, direction = 1, name = &quot;&quot;) +
  scale_colour_brewer(palette = &#39;Pastel1&#39;, direction = 1, name = &quot;&quot;) +
  labs(y = &#39;Difference in means (\u03b2) between\nsexess (Female - Male)&#39;) +
  theme_bw() +
  theme(legend.position = &#39;none&#39;,
        strip.background = element_blank(),
        panel.grid.major.x = element_blank()) +
  NULL</code></pre>
<p><img src="figure/juvenile_development.Rmd/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-13-1">
Past versions of unnamed-chunk-13-1.png
</button>
</p>
<div id="fig-unnamed-chunk-13-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/figure/juvenile_development.Rmd/unnamed-chunk-13-1.png" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/709456c95d21a3528ad4dfa46afbe700888ef4ce/docs/figure/juvenile_development.Rmd/unnamed-chunk-13-1.png" target="_blank">709456c</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2021-01-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/989e86ff1733879de61f286d01a7386021a6a84d/docs/figure/juvenile_development.Rmd/unnamed-chunk-13-1.png" target="_blank">989e86f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/96d1188439aa0c873595bff6ae718123224f28df/docs/figure/juvenile_development.Rmd/unnamed-chunk-13-1.png" target="_blank">96d1188</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-13
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="body-size-differences-wing-vein-iv-length" class="section level1 tabset">
<h1 class="tabset">Body size differences (wing vein IV length)</h1>
<p>We measured the length of wing vein VI as a proxy for body size to test for differences between sexes and treatments as body size may influence development time. Prior to measurement, wing images were anonymised using a custom <a href="https://github.com/henryjuho/Drosophila_wing_length">python script provided by Henry Barton</a> and then decoded for statistical analysis. Wing length was scaled by subtracting the mean (across all measurements) and dividing by the standard deviation.</p>
<div id="inspecting-the-raw-data-1" class="section level3 tabset">
<h3 class="tabset">Inspecting the raw data</h3>
<div id="violin-plots" class="section level4">
<h4>Violin plots</h4>
<pre class="r"><code>wing_length %&gt;% 
  mutate(var = paste(Treatment, Sex)) %&gt;% 
  ggplot(aes(x = Sex, y = Length)) +
  geom_violin(aes(fill = var), alpha = .5) + 
  geom_boxplot(aes(fill = var), width = .1, position = position_dodge(width = .9)) +
  scale_colour_manual(values = c(&quot;pink&quot;, &quot;skyblue&quot;, &quot;red&quot;, &quot;blue&quot;), name = &quot;&quot;) +
  scale_fill_manual(values = c(&quot;pink&quot;, &quot;skyblue&quot;, &quot;red&quot;, &quot;blue&quot;), name = &quot;&quot;,
                    labels = c(&#39;Monogamy Females&#39;, &#39;Monogamy Males&#39;,
                               &#39;Polandry Females&#39;, &#39;Polandry Males&#39;)) +
  labs(y = &#39;Wing vein IV length&#39;) +
  theme_bw() +
  theme() +
  NULL</code></pre>
<p><img src="figure/juvenile_development.Rmd/unnamed-chunk-14-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-14-1">
Past versions of unnamed-chunk-14-1.png
</button>
</p>
<div id="fig-unnamed-chunk-14-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/figure/juvenile_development.Rmd/unnamed-chunk-14-1.png" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/709456c95d21a3528ad4dfa46afbe700888ef4ce/docs/figure/juvenile_development.Rmd/unnamed-chunk-14-1.png" target="_blank">709456c</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2021-01-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/989e86ff1733879de61f286d01a7386021a6a84d/docs/figure/juvenile_development.Rmd/unnamed-chunk-14-1.png" target="_blank">989e86f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/96d1188439aa0c873595bff6ae718123224f28df/docs/figure/juvenile_development.Rmd/unnamed-chunk-14-1.png" target="_blank">96d1188</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/7d4b609075052dc7e107bda649d7ffd41e36ce84/docs/figure/juvenile_development.Rmd/unnamed-chunk-14-1.png" target="_blank">7d4b609</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-05
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Figure X:</strong> Wing vein IV length has been scaled (subtracted the mean and divided by the standard deviation).</p>
</div>
<div id="means-and-standard-errors" class="section level4">
<h4>Means and standard errors</h4>
<pre class="r"><code>wing_length %&gt;% 
  group_by(Treatment, Sex) %&gt;% 
  summarise(Mean = mean(Length),
            `Std. Errors` = sd(Length)/sqrt(n()),
            N = n()) %&gt;%
  mutate(Treatment = recode(Treatment, M = &quot;Monogamy&quot;, P = &#39;Polyandry&#39;),
         Sex = recode(Sex, M = &quot;Male&quot;, F = &#39;Female&#39;)) %&gt;% 
  mutate(across(2:4, round, 2)) %&gt;% 
  kable() %&gt;% 
  kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Treatment
</th>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Std. Errors
</th>
<th style="text-align:right;">
N
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Monogamy
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
152
</td>
</tr>
<tr>
<td style="text-align:left;">
Monogamy
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
-0.91
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
154
</td>
</tr>
<tr>
<td style="text-align:left;">
Polyandry
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
118
</td>
</tr>
<tr>
<td style="text-align:left;">
Polyandry
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
-0.79
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
127
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="fitting-the-model-for-wing-length-in-brms" class="section level3">
<h3>Fitting the model for wing length in <code>brms</code></h3>
<p>We fit a model in <code>brms</code> to test for differences in wing length between the sexes and sexual selection treatments. We fit treatment, sex and the treatment x sex interaction as fixed effects as well as Seed day as a covariate. As above, we included replicate treatment as a random intercept for each of the 8 lines and a random slope term for selection to allow the effect of treatment to vary across replicate lines.</p>
<div id="define-priors-1" class="section level4">
<h4>Define priors</h4>
<p>As above we set conservative normal priors on the fixed effects (mean = 0, sd = 1) and half Cauchy priors on the random effects - <code>LINE</code> - (mean = 0, scale = 0.1). All other priors were left at the default in <code>brms</code>.</p>
</div>
<div id="run-the-model-1" class="section level4">
<h4>Run the model</h4>
<p>The model is run over 4 chains with 10000 iterations each (with the first 2500 discarded as burn-in), for a total of 7500*4 = 30,000 posterior samples.</p>
<pre class="r"><code>if(!file.exists(&quot;output/wing_brms.rds&quot;)){
  
  wing_brms &lt;- brm(Length ~ Treatment * Sex + Seed + (Treatment|LINE),
                 data = wing_length,
  iter = 10000, chains = 4, cores = 4,
  prior = c(set_prior(&quot;normal(0,1)&quot;, class = &quot;b&quot;),
            set_prior(&quot;cauchy(0,0.1)&quot;, class = &quot;sd&quot;)),
  control = list(max_treedepth = 20,
                 adapt_delta = 0.999)
  )
  
  #saveRDS(wing_brms, &quot;output/wing_brms_noslope.rds&quot;) # save with no random slope term
  saveRDS(wing_brms, &quot;output/wing_brms.rds&quot;)
} else {
  wing_brms &lt;- readRDS(&#39;output/wing_brms_noslope.rds&#39;)
}</code></pre>
</div>
</div>
<div id="posterior-predictive-check-of-model-fit" class="section level3">
<h3>Posterior predictive check of model fit</h3>
<pre class="r"><code>pp_check(wing_brms)</code></pre>
<p><img src="figure/juvenile_development.Rmd/unnamed-chunk-17-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-17-1">
Past versions of unnamed-chunk-17-1.png
</button>
</p>
<div id="fig-unnamed-chunk-17-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/figure/juvenile_development.Rmd/unnamed-chunk-17-1.png" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/989e86ff1733879de61f286d01a7386021a6a84d/docs/figure/juvenile_development.Rmd/unnamed-chunk-17-1.png" target="_blank">989e86f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/96d1188439aa0c873595bff6ae718123224f28df/docs/figure/juvenile_development.Rmd/unnamed-chunk-17-1.png" target="_blank">96d1188</a>
</td>
<td>
Martin Garlovsky
</td>
<td>
2020-12-13
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="table-of-model-parameter-estimates---body-size" class="section level3 tabset">
<h3 class="tabset">Table of model parameter estimates - body size</h3>
<div id="formatted-table-1" class="section level4">
<h4>Formatted table</h4>
<pre class="r"><code>wing_test &lt;- bind_rows(
  hypothesis(wing_brms, &#39;TreatmentP = 0&#39;)$hypothesis,
  hypothesis(wing_brms, &#39;SexM = 0&#39;)$hypothesis,
  hypothesis(wing_brms, &#39;TreatmentP:SexM = 0&#39;)$hypothesis,
  hypothesis(wing_brms, &#39;SeedB = 0&#39;)$hypothesis,
  hypothesis(wing_brms, &#39;SeedC = 0&#39;)$hypothesis,
) %&gt;% 
  mutate(Parameter = c(&#39;Treatment (E)&#39;, &#39;Sex (M)&#39;, &#39;Treatment (E) x Sex (M)&#39;,
                       &#39;Seed (B)&#39;, &#39;Seed (C)&#39;),
         across(2:5, round, 3)) %&gt;% 
  relocate(Parameter, Estimate, Est.Error, CI.Lower, CI.Upper, Star)

pvals &lt;- bayestestR::p_direction(wing_brms) %&gt;% 
  as.data.frame() %&gt;%
  mutate(vars = map_chr(str_split(Parameter, &quot;_&quot;), ~ .x[2]),
         p_val = 1 - pd, 
         star = ifelse(p_val &lt; 0.05, &quot;\\*&quot;, &quot;&quot;)) %&gt;%
  select(vars, p_val, star)

wing_test %&gt;% mutate(vars = c(&#39;TreatmentP&#39;, &#39;SexM&#39;, &#39;TreatmentP:SexM&#39;, &#39;SeedB&#39;, &#39;SeedC&#39;)) %&gt;% 
  left_join(pvals %&gt;% filter(vars != &#39;Intercept&#39;), 
              by = c(&quot;vars&quot;)) %&gt;% 
    select(Parameter, Estimate, Est.Error, CI.Lower, CI.Upper, `p` = p_val, star) %&gt;% 
  mutate(p = ifelse(p &gt; 0.001, round(p, 3), &#39;&lt; 0.001&#39;)) %&gt;% 
  rename(` ` = star) %&gt;%
  kable() %&gt;% 
  kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Est.Error
</th>
<th style="text-align:right;">
CI.Lower
</th>
<th style="text-align:right;">
CI.Upper
</th>
<th style="text-align:left;">
p
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Treatment (E)
</td>
<td style="text-align:right;">
0.112
</td>
<td style="text-align:right;">
0.250
</td>
<td style="text-align:right;">
-0.391
</td>
<td style="text-align:right;">
0.609
</td>
<td style="text-align:left;">
0.312
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Sex (M)
</td>
<td style="text-align:right;">
-1.733
</td>
<td style="text-align:right;">
0.045
</td>
<td style="text-align:right;">
-1.823
</td>
<td style="text-align:right;">
-1.644
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left;">
Treatment (E) x Sex (M)
</td>
<td style="text-align:right;">
0.020
</td>
<td style="text-align:right;">
0.068
</td>
<td style="text-align:right;">
-0.112
</td>
<td style="text-align:right;">
0.153
</td>
<td style="text-align:left;">
0.382
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Seed (B)
</td>
<td style="text-align:right;">
-0.098
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
-0.179
</td>
<td style="text-align:right;">
-0.016
</td>
<td style="text-align:left;">
0.01
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left;">
Seed (C)
</td>
<td style="text-align:right;">
-0.029
</td>
<td style="text-align:right;">
0.043
</td>
<td style="text-align:right;">
-0.113
</td>
<td style="text-align:right;">
0.055
</td>
<td style="text-align:left;">
0.246
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
</div>
<div id="complete-output-from-summary.brmsfit-1" class="section level4">
<h4>Complete output from <code>summary.brmsfit()</code></h4>
<pre class="r"><code>wing_brms</code></pre>
<pre> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: Length ~ Treatment * Sex + Seed + (1 | LINE) 
   Data: wing_length (Number of observations: 551) 
  Draws: 4 chains, each with iter = 10000; warmup = 5000; thin = 1;
         total post-warmup draws = 20000

Group-Level Effects: 
~LINE (Number of levels: 8) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.35      0.11     0.20     0.62 1.00     6401     9503

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           0.87      0.18     0.52     1.23 1.00     7468     9147
TreatmentP          0.11      0.25    -0.39     0.61 1.00     7580     9004
SexM               -1.73      0.05    -1.82    -1.64 1.00    15801    13344
SeedB              -0.10      0.04    -0.18    -0.02 1.00    18102    15222
SeedC              -0.03      0.04    -0.11     0.05 1.00    17355    14313
TreatmentP:SexM     0.02      0.07    -0.11     0.15 1.00    15701    14661

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.40      0.01     0.38     0.42 1.00    20880    12410

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).
</pre>
</div>
</div>
<div id="posterior-effect-size-of-treatment-on-body-size-for-each-sex" class="section level3">
<h3>Posterior effect size of treatment on body size for each sex</h3>
<p>We predict the mean wing vein IV length for each treatment and sex from the model averaged across the eight replicate selection lines and seeding days. The plots show the difference in posterior estimates between the E and M treatment for each sex separately. Note that females are larger than males but effect sizes are plotted for each sex separately.</p>
<pre class="r"><code>new &lt;- expand_grid(Sex = c(&quot;M&quot;, &quot;F&quot;),
                   Treatment = c(&quot;M&quot;, &quot;P&quot;),
                   LINE = NA, Seed = NA) %&gt;%
  mutate(type = 1:n())

fitted_wing &lt;- posterior_epred(
  wing_brms, newdata = new, re_formula = NA,
  summary = FALSE, resp = &#39;Length&#39;) %&gt;%
  reshape2::melt() %&gt;% rename(draw = Var1, type = Var2) %&gt;%
  as_tibble() %&gt;%
  left_join(new, by = &quot;type&quot;) %&gt;%
  select(draw, value, Sex, Treatment)

treat_diff_wing &lt;- fitted_wing %&gt;%
  spread(Treatment, value) %&gt;%
  mutate(`Difference in means (Poly - Mono)` = P - M) 

treat_diff_wing %&gt;% 
  ggplot(aes(x = Sex, y = `Difference in means (Poly - Mono)`, fill = Sex)) +
  geom_hline(yintercept = 0, linetype = 2) +
  stat_halfeye() + 
  scale_fill_brewer(palette = &#39;Pastel1&#39;, direction = 1, name = &quot;&quot;) +
  scale_colour_brewer(palette = &#39;Pastel1&#39;, direction = 1, name = &quot;&quot;) +
  labs(y = &#39;Difference in means between\nselection treatments (E - M)&#39;) +
  theme_bw() +
  theme(legend.position = &#39;none&#39;,
        strip.background = element_blank(),
        panel.grid.major.x = element_blank()) +
  NULL</code></pre>
<p><img src="figure/juvenile_development.Rmd/unnamed-chunk-20-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-20-1">
Past versions of unnamed-chunk-20-1.png
</button>
</p>
<div id="fig-unnamed-chunk-20-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/figure/juvenile_development.Rmd/unnamed-chunk-20-1.png" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Figure XX:</strong> Posterior estimates of treatment effects on wing vein IV length (proxy for body size).</p>
</div>
<div id="posterior-difference-in-treatment-effect-size-between-sexes-1" class="section level3 tabset">
<h3 class="tabset">Posterior difference in treatment effect size between sexes</h3>
<p>This section examines the treatment <span class="math inline">\(\times\)</span> sex interaction term, by calculating the difference in the effect size of the E/M treatment between sexes. We find no evidence for a treatment <span class="math inline">\(\times\)</span> sex interaction, i.e. the treatment effects did not differ detectably between sexes.</p>
<div id="figure-1" class="section level4">
<h4>Figure</h4>
<pre class="r"><code>treat_diff_wing %&gt;%
  rename(d = `Difference in means (Poly - Mono)`) %&gt;% 
  select(draw, Sex, d) %&gt;%
  group_by(draw) %&gt;%
  summarise(`Difference in effect size between sexes (male - female)` = d[2] - d[1],
            .groups = &quot;drop&quot;) %&gt;% 
  ggplot(aes(x = `Difference in effect size between sexes (male - female)`, y = 1, fill = stat(x &lt; 0))) +
  geom_vline(xintercept = 0, linetype = 2) +
  stat_halfeye() +
  scale_fill_brewer(palette = &#39;Pastel2&#39;, direction = 1, name = &quot;&quot;) +
  theme_bw() +
  theme(legend.position = &#39;none&#39;,
        text = element_text(family = nice_font),
        strip.background = element_blank()) +
  ylab(&quot;Posterior density&quot;) +
  #ggsave(&quot;figures/wing_interaction_plot.pdf&quot;, height=4, width=4) +
  NULL</code></pre>
<p><img src="figure/juvenile_development.Rmd/unnamed-chunk-21-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-21-1">
Past versions of unnamed-chunk-21-1.png
</button>
</p>
<div id="fig-unnamed-chunk-21-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/21567bbae3fc026d5c2b3c4f9cb4a6bbed091da2/docs/figure/juvenile_development.Rmd/unnamed-chunk-21-1.png" target="_blank">21567bb</a>
</td>
<td>
MartinGarlovsky
</td>
<td>
2021-03-12
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="table-1" class="section level4">
<h4>Table</h4>
<pre class="r"><code>treatsex_interaction_wing &lt;- treat_diff_wing %&gt;%
  select(draw, Sex, d =  `Difference in means (Poly - Mono)`) %&gt;%
  arrange(draw, Sex) %&gt;%
  group_by(draw) %&gt;%
  summarise(`Difference in effect size between sexes (male - female)` = d[2] - d[1],
            .groups = &quot;drop&quot;) # males - females

treatsex_interaction_wing %&gt;%
  rename(x = `Difference in effect size between sexes (male - female)`) %&gt;%
  summarise(`Difference in effect size between sexes (male - female)` = median(x),
            `Lower 95% CI` = quantile(x, probs = 0.025), 
            `Upper 95% CI` = quantile(x, probs = 0.975),
            p = 1 - as.numeric(bayestestR::p_direction(x)),
            ` ` = ifelse(p &lt; 0.05, &quot;\\*&quot;, &quot;&quot;),
            .groups = &quot;drop&quot;) %&gt;%
  kable(digits=3) %&gt;%
  kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Difference in effect size between sexes (male - female)
</th>
<th style="text-align:right;">
Lower 95% CI
</th>
<th style="text-align:right;">
Upper 95% CI
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.112
</td>
<td style="text-align:right;">
0.153
</td>
<td style="text-align:right;">
0.382
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre>R version 4.0.3 (2020-10-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] showtext_0.9-4   showtextdb_3.0   sysfonts_0.8.5   knitrhooks_0.0.4
 [5] knitr_1.33       kableExtra_1.3.4 tidybayes_3.0.1  brms_2.16.1     
 [9] Rcpp_1.0.7       coxme_2.2-16     bdsmatrix_1.3-4  survival_3.2-12 
[13] ggridges_0.5.3   forcats_0.5.1    stringr_1.4.0    dplyr_1.0.7     
[17] purrr_0.3.4      readr_2.0.1      tidyr_1.1.3      tibble_3.1.3    
[21] ggplot2_3.3.5    tidyverse_1.3.1  workflowr_1.6.2 

loaded via a namespace (and not attached):
  [1] utf8_1.2.2           tidyselect_1.1.1     lme4_1.1-27.1       
  [4] htmlwidgets_1.5.3    grid_4.0.3           munsell_0.5.0       
  [7] codetools_0.2-18     DT_0.18              miniUI_0.1.1.1      
 [10] withr_2.4.2          Brobdingnag_1.2-6    colorspace_2.0-2    
 [13] highr_0.9            rstudioapi_0.13      stats4_4.0.3        
 [16] ggsignif_0.6.2       bayesplot_1.8.1      labeling_0.4.2      
 [19] git2r_0.28.0         rstan_2.21.1         KMsurv_0.1-5        
 [22] farver_2.1.0         datawizard_0.2.0     bridgesampling_1.1-2
 [25] rprojroot_2.0.2      coda_0.19-4          vctrs_0.3.8         
 [28] generics_0.1.0       xfun_0.25            R6_2.5.1            
 [31] markdown_1.1         gamm4_0.2-6          projpred_2.0.2      
 [34] reshape_0.8.8        assertthat_0.2.1     promises_1.2.0.1    
 [37] scales_1.1.1         gtable_0.3.0         processx_3.5.2      
 [40] rlang_0.4.11         systemfonts_1.0.2    splines_4.0.3       
 [43] rstatix_0.7.0        broom_0.7.9          checkmate_2.0.0     
 [46] inline_0.3.19        yaml_2.2.1           reshape2_1.4.4      
 [49] abind_1.4-5          modelr_0.1.8         threejs_0.3.3       
 [52] crosstalk_1.1.1      backports_1.2.1      httpuv_1.6.2        
 [55] rsconnect_0.8.24     tensorA_0.36.2       tools_4.0.3         
 [58] ellipsis_0.3.2       RColorBrewer_1.1-2   jquerylib_0.1.4     
 [61] posterior_1.0.1      plyr_1.8.6           base64enc_0.1-3     
 [64] ps_1.6.0             prettyunits_1.1.1    ggpubr_0.4.0        
 [67] zoo_1.8-9            haven_2.4.3          fs_1.5.0            
 [70] magrittr_2.0.1       data.table_1.14.0    ggdist_3.0.0        
 [73] openxlsx_4.2.4       colourpicker_1.1.0   reprex_2.0.1        
 [76] survminer_0.4.9      mvtnorm_1.1-2        whisker_0.4         
 [79] matrixStats_0.60.0   hms_1.1.0            shinyjs_2.0.0       
 [82] mime_0.11            evaluate_0.14        arrayhelpers_1.1-0  
 [85] xtable_1.8-4         shinystan_2.5.0      rio_0.5.27          
 [88] readxl_1.3.1         gridExtra_2.3        rstantools_2.1.1    
 [91] compiler_4.0.3       V8_3.4.2             crayon_1.4.1        
 [94] minqa_1.2.4          StanHeaders_2.21.0-7 htmltools_0.5.1.1   
 [97] mgcv_1.8-36          later_1.3.0          tzdb_0.1.2          
[100] RcppParallel_5.1.4   lubridate_1.7.10     DBI_1.1.1           
[103] dbplyr_2.1.1         MASS_7.3-54          boot_1.3-28         
[106] Matrix_1.3-4         car_3.0-11           cli_3.0.1           
[109] insight_0.14.3       parallel_4.0.3       igraph_1.2.6        
[112] pkgconfig_2.0.3      km.ci_0.5-2          foreign_0.8-81      
[115] xml2_1.3.2           svUnit_1.0.6         dygraphs_1.1.1.6    
[118] svglite_2.0.0        bslib_0.2.5.1        webshot_0.5.2       
[121] rvest_1.0.1          distributional_0.2.2 callr_3.7.0         
[124] digest_0.6.27        rmarkdown_2.10       cellranger_1.1.0    
[127] survMisc_0.5.5       curl_4.3.2           shiny_1.6.0         
[130] gtools_3.9.2         nloptr_1.2.2.2       lifecycle_1.0.0     
[133] nlme_3.1-152         jsonlite_1.7.2       carData_3.0-4       
[136] viridisLite_0.4.0    fansi_0.5.0          pillar_1.6.2        
[139] lattice_0.20-44      loo_2.4.1            fastmap_1.1.0       
[142] httr_1.4.2           pkgbuild_1.2.0       glue_1.4.2          
[145] xts_0.12.1           bayestestR_0.10.5    zip_2.2.0           
[148] shinythemes_1.2.0    stringi_1.7.3        sass_0.4.0          
</pre>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
