<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Respirometry</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.13/datatables.js"></script>
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="site_libs/dt-ext-scroller-1.10.20/css/scroller.dataTables.min.css" rel="stylesheet" />
<script src="site_libs/dt-ext-scroller-1.10.20/js/dataTables.scroller.min.js"></script>
<script src="site_libs/pdfmake-1.10.20/pdfmake.js"></script>
<script src="site_libs/pdfmake-1.10.20/vfs_fonts.js"></script>
<link href="site_libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="site_libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<script src="site_libs/viz-1.8.2/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-1.0.6.1/grViz.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"> </a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="juvenile_development.html">Development</a>
</li>
<li>
  <a href="resistance.html">Resistance</a>
</li>
<li>
  <a href="metabolites.html">Respirometry</a>
</li>
<li>
  <a href="metabolites.html">Metabolites</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lukeholman/exp_evol_respiration">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Respirometry</h1>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2020-12-18
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>exp_evol_respiration/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20190703code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20190703)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20190703code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20190703)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomlukeholmanexpevolrespirationtree74a53c0d659343c381164537e70c5595b2a7deb0targetblank74a53c0a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/lukeholman/exp_evol_respiration/tree/74a53c0d659343c381164537e70c5595b2a7deb0" target="_blank">74a53c0</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomlukeholmanexpevolrespirationtree74a53c0d659343c381164537e70c5595b2a7deb0targetblank74a53c0a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/lukeholman/exp_evol_respiration/tree/74a53c0d659343c381164537e70c5595b2a7deb0" target="_blank">74a53c0</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rapp.history
    Ignored:    .Rproj.user/
    Ignored:    analysis/.DS_Store
    Ignored:    figures/
    Ignored:    output/.DS_Store

Untracked files:
    Untracked:  code/old mediator variable code.R

Unstaged changes:
    Modified:   .gitignore
    Modified:   analysis/metabolites.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/respirometry.Rmd</code>) and HTML (<code>docs/respirometry.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/74a53c0d659343c381164537e70c5595b2a7deb0/analysis/respirometry.Rmd" target="_blank">74a53c0</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
new menu
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/0d5bcc951f100a27ab74393063a546d55dd75d78/docs/respirometry.html" target="_blank">0d5bcc9</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/989e86ff1733879de61f286d01a7386021a6a84d/docs/respirometry.html" target="_blank">989e86f</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/d3f10f895f80892ee6c166fdd374d913c2c96427/docs/respirometry.html" target="_blank">d3f10f8</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/603958889f4ebdd525106c22325efde8db5121c5/analysis/respirometry.Rmd" target="_blank">6039588</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
new menu
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/4b2ed7018d65ad5855bb0ca0773819b5b074e964/docs/respirometry.html" target="_blank">4b2ed70</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/7dcf48a9a626dbaac2d1da8ad91ae16cef693eac/analysis/respirometry.Rmd" target="_blank">7dcf48a</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Fix pairs plot
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/2791e70bfba58cbb5318dbbb6a52cb0c9bbccdef/docs/respirometry.html" target="_blank">2791e70</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/cc92e06ab951064b4abf5c1082b96c40ce6f2239/analysis/respirometry.Rmd" target="_blank">cc92e06</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Fix pairs plot
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/47bc2174467f7d0563f5c0094ceb51ebfe35f4d2/docs/respirometry.html" target="_blank">47bc217</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/5a0449449231c26f4404a033d1db4a58a63125f0/analysis/respirometry.Rmd" target="_blank">5a04494</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Fix pairs plot
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/a14c3784a106e71d73e04484412547fc29aa1d82/docs/respirometry.html" target="_blank">a14c378</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/cfcdbe7ad1e96fe0ac37aa2c7dc26b3ba36ff2df/analysis/respirometry.Rmd" target="_blank">cfcdbe7</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
New respirometry analysis
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/f3995d21390ef07af5f91bf252373fc2951a7d0c/docs/respirometry.html" target="_blank">f3995d2</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/71fee665228ac28114dc7e8577466dacb53da072/analysis/respirometry.Rmd" target="_blank">71fee66</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
New respirometry analysis
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/de480f2af7cf9b9e4471286c1f3cb296ab62a741/docs/respirometry.html" target="_blank">de480f2</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/9601014ee0786c1a3f3192b30a266e301ad1be57/analysis/respirometry.Rmd" target="_blank">9601014</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
New respirometry analysis
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/lukeholman/exp_evol_respiration/2fc158d6b5ce97ffbdd73c6cd7a9b4b9ef14e28f/docs/respirometry.html" target="_blank">2fc158d</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/26864adb549c9341a26b7ad4e2d98fdb35bf0b1a/analysis/respirometry.Rmd" target="_blank">26864ad</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
<td>
New respirometry analysis
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/c8feb2d375c449e40555f76ffe6d557a6424980b/analysis/respirometry.Rmd" target="_blank">c8feb2d</a>
</td>
<td>
lukeholman
</td>
<td>
2020-11-30
</td>
<td>
Same page with Martin
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="load-r-packages" class="section level2">
<h2>Load R packages</h2>
<pre class="r"><code># it was slightly harder to install the showtext package. On Mac, I did this:
# installed &#39;homebrew&#39; using Terminal: ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot; 
# installed &#39;libpng&#39; using Terminal: brew install libpng
# installed &#39;showtext&#39; in R using: devtools::install_github(&quot;yixuan/showtext&quot;)  

library(tidyverse)
library(gridExtra)
library(grid)
library(brms)
library(RColorBrewer)
library(glue)
library(kableExtra)
library(tidybayes)
library(bayestestR)
library(MuMIn)
library(glue)
library(ggridges)
library(future)
library(future.apply)
library(GGally)
library(DT)
library(showtext)

library(knitrhooks) # install with devtools::install_github(&quot;nathaneastwood/knitrhooks&quot;)

output_max_height() # a knitrhook option
options(stringsAsFactors = FALSE)

# set up nice font for figure
nice_font &lt;- &quot;Lora&quot;
font_add_google(name = nice_font, family = nice_font, regular.wt = 400, bold.wt = 700)
showtext_auto()

# Define function for the inverse logit
inv_logit &lt;- function(x) 1 / (1 + exp(-x))</code></pre>
</div>
<div id="inspect-the-raw-data" class="section level2">
<h2>Inspect the raw data</h2>
<p>This analysis set out to test whether sexual selection treatment had an effect on respiration in the flies. The variables in the raw data are as follows:</p>
<ul>
<li><code>SELECTION</code> The selection treatment of the focal triad of flies (monandry or polyandry)</li>
<li><code>SEX</code> The sex of the focal triad of flies (male or female)</li>
<li><code>LINE</code> The replicate selection line (M1-4 and P1-4)</li>
<li><code>SAMPLE</code> Grouping variable that identifies the specific triad of flies (there are three measurements of each for all response variables except body weight). The have names like <code>M1T1F</code> (i.e. the first triad of females from line M1)</li>
<li><code>CYCLE</code> The respirometry cycle (three measurements were taken, with cycle I being the first and cycle III the last)</li>
<li><code>VO2</code> The amount of O<span class="math inline">\(_2\)</span> produced over the cycle</li>
<li><code>VCO2</code> The amount of CO<span class="math inline">\(_2\)</span> consumed over the cycle</li>
<li><code>RQ</code> The respiratory quotient, i.e. <code>VCO2</code> / <code>VO2</code></li>
<li><code>ACTIVITY</code> The amount of locomotor activity by the triad of flies over the focal cycle; measured by infrared light</li>
<li><code>BODYMASS</code> The mass/weight of the triad of flies, measured to the nearest 0.1mg.</li>
</ul>
<p>We expect body weight and activity levels to vary between the sexes and potentially between treatments. In turn, we expect these two ‘mediator variables’ to co-vary with respiratory flux, e.g. because larger flies have more respiring tissue, and because more active flies would have more active metabolism. There might also be weight- and activity-independent effects of sex and selection treatment on respiration, e.g. because of differences in resting metabolic rate.</p>
<div id="raw-numbers" class="section level3">
<h3>Raw numbers</h3>
<pre class="r"><code>respiration &lt;- read_csv(&quot;data/2.metabolic_rates.csv&quot;) %&gt;%
  rename(SELECTION = `?SELECTION`,
         BODYMASS = BODY_WEIGHT)

my_data_table &lt;- function(df){
  datatable(
    df, rownames=FALSE,
    autoHideNavigation = TRUE,
    extensions = c(&quot;Scroller&quot;,  &quot;Buttons&quot;),
    options = list(
      dom = &#39;Bfrtip&#39;,
      deferRender=TRUE,
      scrollX=TRUE, scrollY=400,
      scrollCollapse=TRUE,
      buttons = 
        list(&#39;csv&#39;, list(
          extend = &#39;pdf&#39;,
          pageSize = &#39;A4&#39;,
          orientation = &#39;landscape&#39;,
          filename = &#39;Dpseudo_respiration&#39;)),
      pageLength = 50
    )
  )
}

respiration %&gt;%
  mutate_if(is.numeric, ~ format(round(.x, 3), nsmall = 3)) %&gt;%
  my_data_table()</code></pre>
<div id="htmlwidget-6ec5e240e3b68e9cc473" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6ec5e240e3b68e9cc473">{"x":{"filter":"none","extensions":["Scroller","Buttons"],"autoHideNavigation":true,"data":[["Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly"],["F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M"],["M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4"],["M1T1F","M1T1F","M1T1F","M1T2F","M1T2F","M1T2F","M1T3F","M1T3F","M1T3F","M1T1M","M1T1M","M1T1M","M1T2M","M1T2M","M1T2M","M1T3M","M1T3M","M1T3M","M2T1F","M2T1F","M2T1F","M2T2F","M2T2F","M2T2F","M2T3F","M2T3F","M2T3F","M2T1M","M2T1M","M2T1M","M2T2M","M2T2M","M2T2M","M2T3M","M2T3M","M2T3M","M3T1F","M3T1F","M3T1F","M3T2F","M3T2F","M3T2F","M3T3F","M3T3F","M3T3F","M3T1M","M3T1M","M3T1M","M3T2M","M3T2M","M3T2M","M3T3M","M3T3M","M3T3M","M4T1F","M4T1F","M4T1F","M4T2F","M4T2F","M4T2F","M4T3F","M4T3F","M4T3F","M4T1M","M4T1M","M4T1M","M4T2M","M4T2M","M4T2M","M4T3M","M4T3M","M4T3M","P1T1F","P1T1F","P1T1F","P1T2F","P1T2F","P1T2F","P1T3F","P1T3F","P1T3F","P1T1M","P1T1M","P1T1M","P1T2M","P1T2M","P1T2M","P1T3M","P1T3M","P1T3M","P2T1F","P2T1F","P2T1F","P2T2F","P2T2F","P2T2F","P2T3F","P2T3F","P2T3F","P2T1M","P2T1M","P2T1M","P2T2M","P2T2M","P2T2M","P2T3M","P2T3M","P2T3M","P3T1F","P3T1F","P3T1F","P3T2F","P3T2F","P3T2F","P3T3F","P3T3F","P3T3F","P3T1M","P3T1M","P3T1M","P3T2M","P3T2M","P3T2M","P3T3M","P3T3M","P3T3M","P4T1F","P4T1F","P4T1F","P4T2F","P4T2F","P4T2F","P4T3F","P4T3F","P4T3F","P4T1M","P4T1M","P4T1M","P4T2M","P4T2M","P4T2M","P4T3M","P4T3M","P4T3M"],["I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III"],["0.007","0.006","0.005","0.007","0.007","0.005","0.006","0.004","0.004","0.007","0.006","0.003","0.009","0.005","0.004","0.007","0.005","0.003","0.007","0.007","0.006","0.010","0.007","0.006","0.006","0.007","0.006","0.005","0.006","0.003","0.007","0.005","0.003","0.010","0.007","0.006","0.008","0.005","0.005","0.005","0.005","0.004","0.008","0.007","0.005","0.005","0.004","0.003","0.008","0.005","0.005","0.003","0.003","0.002","0.011","0.007","0.008","0.011","0.007","0.008","0.008","0.007","0.008","0.007","0.005","0.003","0.005","0.007","0.005","0.003","0.005","0.002","0.005","0.007","0.006","0.008","0.007","0.004","0.009","0.007","0.009","0.011","0.009","0.009","0.005","0.008","0.008","0.008","0.007","0.008","0.009","0.008","0.005","0.011","0.012","0.009","0.009","0.010","0.006","0.008","0.008","0.006","0.010","0.011","0.008","0.009","0.006","0.005","0.005","0.005","0.004","0.008","0.007","0.006","0.008","0.006","0.006","0.008","0.005","0.005","0.007","0.004","0.004","0.009","0.008","0.006","0.007","0.006","0.007","0.011","0.010","0.010","0.010","0.010","0.009","0.009","0.008","0.006","0.008","0.007","0.004","0.006","0.008","0.007"],["0.005","0.005","0.003","0.006","0.005","0.004","0.005","0.004","0.003","0.007","0.005","0.003","0.007","0.004","0.003","0.007","0.005","0.003","0.005","0.006","0.005","0.008","0.006","0.005","0.006","0.006","0.005","0.005","0.005","0.003","0.006","0.004","0.003","0.008","0.006","0.004","0.007","0.004","0.005","0.004","0.005","0.004","0.008","0.006","0.004","0.004","0.004","0.003","0.007","0.005","0.004","0.004","0.004","0.003","0.009","0.007","0.007","0.009","0.007","0.007","0.009","0.006","0.008","0.006","0.004","0.003","0.005","0.005","0.005","0.004","0.005","0.003","0.005","0.006","0.006","0.007","0.007","0.004","0.008","0.006","0.008","0.010","0.008","0.007","0.004","0.006","0.006","0.006","0.006","0.007","0.007","0.007","0.005","0.009","0.010","0.008","0.007","0.008","0.005","0.006","0.007","0.004","0.012","0.010","0.007","0.007","0.005","0.005","0.005","0.005","0.004","0.007","0.007","0.007","0.007","0.006","0.005","0.007","0.005","0.004","0.006","0.004","0.004","0.007","0.006","0.005","0.007","0.006","0.006","0.009","0.009","0.008","0.008","0.009","0.008","0.008","0.007","0.006","0.007","0.006","0.005","0.006","0.007","0.006"],["0.795","0.797","0.691","0.845","0.768","0.766","0.785","0.789","0.807","0.982","0.896","1.069","0.808","0.857","0.703","0.921","1.002","1.088","0.829","0.837","0.879","0.781","0.858","0.848","0.906","0.882","0.787","0.887","0.826","1.054","0.804","0.853","0.996","0.808","0.826","0.745","0.949","0.937","0.951","0.964","0.965","0.967","1.024","0.889","0.881","0.902","1.115","1.098","0.887","0.978","0.784","1.167","1.168","1.434","0.799","0.993","0.796","0.799","0.993","0.796","1.054","0.861","0.895","0.804","0.853","0.996","0.907","0.741","0.871","1.159","0.885","1.306","0.958","0.846","0.893","0.919","0.923","1.259","0.833","0.955","0.819","0.934","0.881","0.814","0.811","0.793","0.780","0.814","0.865","0.837","0.826","0.842","0.982","0.820","0.849","0.907","0.762","0.797","0.873","0.816","0.922","0.771","1.120","0.893","0.884","0.814","0.785","0.885","0.919","0.997","1.176","0.851","1.020","1.015","0.810","0.936","0.866","0.957","0.893","0.837","0.843","0.836","0.851","0.823","0.824","0.928","0.991","1.020","0.926","0.858","0.889","0.818","0.813","0.822","0.873","0.935","0.889","0.947","0.916","0.846","1.214","0.958","0.816","0.864"],["0.017","0.013","0.005","0.005","0.011","0.005","0.010","0.007","0.005","0.047","0.041","0.027","0.059","0.023","0.008","0.020","0.012","0.005","0.007","0.011","0.036","0.032","0.041","0.013","0.010","0.010","0.011","0.007","0.005","0.005","0.048","0.016","0.020","0.043","0.029","0.008","0.022","0.006","0.032","0.005","0.036","0.040","0.009","0.028","0.023","0.009","0.005","0.026","0.012","0.019","0.005","0.026","0.038","0.030","0.005","0.025","0.009","0.005","0.025","0.009","0.006","0.005","0.048","0.048","0.016","0.020","0.006","0.013","0.015","0.004","0.004","0.004","0.014","0.051","0.047","0.051","0.009","0.018","0.056","0.049","0.063","0.058","0.047","0.044","0.029","0.061","0.072","0.041","0.051","0.058","0.027","0.031","0.031","0.054","0.063","0.050","0.097","0.084","0.074","0.045","0.050","0.040","0.069","0.062","0.061","0.066","0.049","0.046","0.010","0.006","0.007","0.033","0.052","0.060","0.011","0.044","0.035","0.052","0.051","0.017","0.042","0.038","0.031","0.051","0.048","0.052","0.004","0.004","0.004","0.074","0.091","0.075","0.079","0.101","0.097","0.065","0.075","0.073","0.030","0.043","0.061","0.051","0.073","0.075"],["0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.002","0.002","0.002","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.002","0.002","0.002","0.002","0.002","0.002","0.002","0.002","0.002","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.002","0.002","0.002","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001","0.001"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>SELECTION<\/th>\n      <th>SEX<\/th>\n      <th>LINE<\/th>\n      <th>SAMPLE<\/th>\n      <th>CYCLE<\/th>\n      <th>VO2<\/th>\n      <th>VCO2<\/th>\n      <th>RQ<\/th>\n      <th>ACTIVITY<\/th>\n      <th>BODYMASS<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","deferRender":true,"scrollX":true,"scrollY":400,"scrollCollapse":true,"buttons":["csv",{"extend":"pdf","pageSize":"A4","orientation":"landscape","filename":"Dpseudo_respiration"}],"pageLength":50,"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="plot-of-correlations-between-variables" class="section level3">
<h3>Plot of correlations between variables</h3>
<pre class="r"><code>cols &lt;- c(&quot;M females&quot; = &quot;pink&quot;, 
          &quot;P females&quot; = &quot;red&quot;, 
          &quot;M males&quot; = &quot;skyblue&quot;, 
          &quot;P males&quot; = &quot;blue&quot;)

modified_densityDiag &lt;- function(data, mapping, ...) {
  ggally_densityDiag(data, mapping, colour = &quot;grey10&quot;, ...) + 
    scale_fill_manual(values = cols) + 
  scale_x_continuous(guide = guide_axis(check.overlap = TRUE))
}

modified_points &lt;- function(data, mapping, ...) {
  ggally_points(data, mapping, pch = 21, colour = &quot;grey10&quot;, ...) +
    scale_fill_manual(values = cols) + 
    scale_x_continuous(guide = guide_axis(check.overlap = TRUE))
}

modified_facetdensity &lt;- function(data, mapping, ...) {
  ggally_facetdensity(data, mapping, ...) + 
    scale_colour_manual(values = cols)
}

modified_box_no_facet &lt;- function(data, mapping, ...) {
  ggally_box_no_facet(data, mapping, colour = &quot;grey10&quot;, ...) +
    scale_fill_manual(values = cols)
}

respiration_pairs_plot &lt;- respiration %&gt;% 
  select(SEX, SELECTION, CYCLE, VO2, VCO2, RQ, ACTIVITY, BODYMASS) %&gt;%
  mutate(VO2 = VO2 * 1000, 
         VCO2 = VCO2 * 1000, 
         BODYMASS = BODYMASS * 1000, 
         ACTIVITY = ACTIVITY * 100) %&gt;%
  mutate(SEX = factor(ifelse(SEX == &quot;M&quot;, &quot;males&quot;, &quot;females&quot;)),
         SELECTION = factor(ifelse(SELECTION == &quot;Mono&quot;, &quot;M&quot;, &quot;P&quot;)),
         `Sex and treatment` = factor(paste(SELECTION, SEX), c(&quot;M males&quot;, &quot;P males&quot;, &quot;M females&quot;, &quot;P females&quot;))) %&gt;%
  mutate_if(is.numeric, ~ as.numeric(scale(.x))) %&gt;%
  select(-SEX, -SELECTION) %&gt;%
  rename(Cycle = CYCLE, Activity = ACTIVITY, `Body mass` = BODYMASS) %&gt;% 
  select(VO2, VCO2, RQ, Activity, `Body mass`, `Sex and treatment`, Cycle) %&gt;%
  ggpairs(aes(colour = `Sex and treatment`, fill = `Sex and treatment`),
          diag = list(continuous = wrap(modified_densityDiag, alpha = 0.7),
                      discrete = wrap(&quot;blank&quot;)),
          lower = list(continuous = wrap(modified_points, alpha = 0.7, size = 1.1), 
                       discrete = wrap(&quot;blank&quot;),
                       combo = wrap(modified_box_no_facet, alpha = 0.7)),
          upper = list(continuous = wrap(modified_points, alpha = 0.7, size = 1.1),
                       discrete = wrap(&quot;blank&quot;),
                       combo = wrap(modified_box_no_facet, alpha = 0.7, size = 0.5))) 

respiration_pairs_plot %&gt;% ggsave(filename = &quot;figures/respiration_pairs_plot.pdf&quot;, height = 10, width = 10)
respiration_pairs_plot</code></pre>
<p><img src="figure/respirometry.Rmd/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-1">
Past versions of unnamed-chunk-3-1.png
</button>
</p>
<div id="fig-unnamed-chunk-3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/47bc2174467f7d0563f5c0094ceb51ebfe35f4d2/docs/figure/respirometry.Rmd/unnamed-chunk-3-1.png" target="_blank">47bc217</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/a14c3784a106e71d73e04484412547fc29aa1d82/docs/figure/respirometry.Rmd/unnamed-chunk-3-1.png" target="_blank">a14c378</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Figure XX:</strong> Boxplots, scatterplots, and density plots illustrating the means, variances and covariances of the explanatory variables (<code>Treatment</code>, <code>Sex</code>, and <code>Cycle</code>) and the five response variables. The data are coloured by treatment (red: polyandry, blue: monogamy). The plot shows the raw data in their original units, namely the number of mm of O<span class="math inline">\(_2\)</span> consumed or CO<span class="math inline">\(_2\)</span> produced, the % time spent active, and the body mass in milligrams; the respiratory quotient (RQ) is a unitless ratio. Note that the true value of RQ must lie within the range of 0.7-1.0 because of the chemistry of respiration, but estimates of RQ can lie outside this range due to sampling variance and measurement error for O<span class="math inline">\(_2\)</span> and CO<span class="math inline">\(_2\)</span>.</p>
</div>
<div id="group-means" class="section level3 tabset">
<h3>Group means</h3>
<div id="body-weight-per-individual" class="section level4">
<h4>Body weight (per individual)</h4>
<pre class="r"><code>se &lt;- function(x) sd(x) / sqrt(length(x))
respiration %&gt;% 
  select(SEX, SELECTION, BODYMASS) %&gt;%
  distinct() %&gt;%
  group_by(SEX, SELECTION) %&gt;% 
  summarise(`Mean weight per fly (mg)` = mean(BODYMASS * 1000 / 3), 
            SE = se(BODYMASS * 1000 / 3), 
            n = n()) %&gt;% 
  kable(digits = 2) %&gt;% kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
SEX
</th>
<th style="text-align:left;">
SELECTION
</th>
<th style="text-align:right;">
Mean weight per fly (mg)
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
12
</td>
</tr>
</tbody>
</table>
</div>
<div id="mean-activity-level" class="section level4">
<h4>Mean activity level</h4>
<pre class="r"><code>respiration %&gt;% 
  select(SEX, SELECTION, ACTIVITY, CYCLE) %&gt;%
  distinct() %&gt;%
  group_by(SEX, SELECTION, CYCLE) %&gt;% 
  summarise(`Mean activity level` = mean(ACTIVITY * 1000 / 3), 
            SE = se(ACTIVITY * 1000 / 3), 
            n = n()) %&gt;% 
  kable(digits = 2) %&gt;% kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
SEX
</th>
<th style="text-align:left;">
SELECTION
</th>
<th style="text-align:left;">
CYCLE
</th>
<th style="text-align:right;">
Mean activity level
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
3.81
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
5.85
</td>
<td style="text-align:right;">
1.28
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
6.87
</td>
<td style="text-align:right;">
1.59
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
14.16
</td>
<td style="text-align:right;">
2.95
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
16.24
</td>
<td style="text-align:right;">
3.14
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
15.63
</td>
<td style="text-align:right;">
2.78
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
8.48
</td>
<td style="text-align:right;">
2.03
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
6.23
</td>
<td style="text-align:right;">
1.31
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
4.67
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
16.62
</td>
<td style="text-align:right;">
1.27
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
18.02
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
17.45
</td>
<td style="text-align:right;">
1.71
</td>
<td style="text-align:right;">
12
</td>
</tr>
</tbody>
</table>
</div>
<div id="mean-vo_2" class="section level4">
<h4>Mean VO<span class="math inline">\(_2\)</span></h4>
<pre class="r"><code>respiration %&gt;% 
  select(SEX, SELECTION, VO2, CYCLE) %&gt;%
  distinct() %&gt;%
  group_by(SEX, SELECTION, CYCLE) %&gt;% 
  summarise(`Mean VO2` = mean(VO2 * 1000), 
            SE = se(VO2 * 1000), 
            n = n()) %&gt;% 
  kable(digits = 2) %&gt;% kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
SEX
</th>
<th style="text-align:left;">
SELECTION
</th>
<th style="text-align:left;">
CYCLE
</th>
<th style="text-align:right;">
Mean VO2
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
7.48
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
6.39
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
5.74
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
8.43
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
7.98
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
6.73
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
6.29
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
5.19
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
3.63
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
8.11
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
7.44
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
6.37
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
12
</td>
</tr>
</tbody>
</table>
</div>
<div id="mean-vco_2" class="section level4">
<h4>Mean VCO<span class="math inline">\(_2\)</span></h4>
<pre class="r"><code>respiration %&gt;% 
  select(SEX, SELECTION, VCO2, CYCLE) %&gt;%
  distinct() %&gt;%
  group_by(SEX, SELECTION, CYCLE) %&gt;% 
  summarise(`Mean VCO2` = mean(VCO2 * 1000), 
            SE = se(VCO2 * 1000), 
            n = n()) %&gt;% 
  kable(digits = 2) %&gt;% kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
SEX
</th>
<th style="text-align:left;">
SELECTION
</th>
<th style="text-align:left;">
CYCLE
</th>
<th style="text-align:right;">
Mean VCO2
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
6.59
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
5.56
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
4.83
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
7.20
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
7.13
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
6.18
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
5.65
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
4.66
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
3.44
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
7.32
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
6.37
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
5.56
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
12
</td>
</tr>
</tbody>
</table>
</div>
<div id="mean-rq" class="section level4">
<h4>Mean RQ</h4>
<pre class="r"><code>respiration %&gt;% 
  select(SEX, SELECTION, RQ, CYCLE) %&gt;%
  distinct() %&gt;%
  group_by(SEX, SELECTION, CYCLE) %&gt;% 
  summarise(`Mean VO2` = mean(RQ), 
            SE = se(RQ), 
            n = n()) %&gt;% 
  kable(digits = 2) %&gt;% kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
SEX
</th>
<th style="text-align:left;">
SELECTION
</th>
<th style="text-align:left;">
CYCLE
</th>
<th style="text-align:right;">
Mean VO2
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Mono
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
1.01
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Poly
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
12
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="draw-the-causal-diagram" class="section level2">
<h2>Draw the causal diagram</h2>
<pre class="r"><code>DiagrammeR::grViz(&#39;digraph {

graph [layout = dot, rankdir = LR]

# define the global styles of the nodes. We can override these in box if we wish
node [shape = rectangle, style = filled, fillcolor = Linen]

&quot;Metabolic\nrate&quot; [shape = oval, fillcolor = Beige]
&quot;Metabolic\nsubstrate&quot; [shape = oval, fillcolor = Beige]
&quot;Other factors\n(e.g. physiology)&quot; [shape = oval, fillcolor = Beige]

# edge definitions with the node IDs
&quot;Mating system\ntreatment (M vs P)&quot; -&gt; {&quot;Other factors\n(e.g. physiology)&quot;, &quot;Body mass&quot; , &quot;Activity&quot;} -&gt; {&quot;Metabolic\nrate&quot;, &quot;Metabolic\nsubstrate&quot;} 

{&quot;Metabolic\nrate&quot;} -&gt; {&quot;O\u2082 consumption&quot;, &quot;CO\u2082 production&quot;}
{&quot;O\u2082 consumption&quot;, &quot;CO\u2082 production&quot;} -&gt; &quot;Respiratory\nquotient (RQ)&quot;
{&quot;Metabolic\nsubstrate&quot;} -&gt; &quot;Respiratory\nquotient (RQ)&quot;
}&#39;)</code></pre>
<p><div id="htmlwidget-75f34d55b8360186c6cf" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-75f34d55b8360186c6cf">{"x":{"diagram":"digraph {\n\ngraph [layout = dot, rankdir = LR]\n\n# define the global styles of the nodes. We can override these in box if we wish\nnode [shape = rectangle, style = filled, fillcolor = Linen]\n\n\"Metabolic\nrate\" [shape = oval, fillcolor = Beige]\n\"Metabolic\nsubstrate\" [shape = oval, fillcolor = Beige]\n\"Other factors\n(e.g. physiology)\" [shape = oval, fillcolor = Beige]\n\n# edge definitions with the node IDs\n\"Mating system\ntreatment (M vs P)\" -> {\"Other factors\n(e.g. physiology)\", \"Body mass\" , \"Activity\"} -> {\"Metabolic\nrate\", \"Metabolic\nsubstrate\"} \n\n{\"Metabolic\nrate\"} -> {\"O₂ consumption\", \"CO₂ production\"}\n{\"O₂ consumption\", \"CO₂ production\"} -> \"Respiratory\nquotient (RQ)\"\n{\"Metabolic\nsubstrate\"} -> \"Respiratory\nquotient (RQ)\"\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script> <br></br> <strong>Figure XX:</strong> Directed acyclic graph (DAG) showing the key causal relationships that we hypothesised <em>a priori</em> between the measured variables (squares) and latent variables (ovals). This DAG motivated the Bayesian structural equation model discussed in the Methods and Results, which attempts to decompose the effects of treatment on respiration (measured via O2 and CO2 flux, and their ratio, RQ) into paths that travel via body mass, activity, or other unmeasured factors such as physiology.</p>
</div>
<div id="fit-bayesian-structural-equation-model-sem-via-brms" class="section level2">
<h2>Fit Bayesian structural equation model (SEM) via <code>brms</code></h2>
<div id="scale-the-data" class="section level3">
<h3>Scale the data</h3>
<p>Here, we mean-center and scale body mass and activity. We also multiply <code>VO2</code> and <code>VCO2</code> by 1000, such that their units (and thus the associated regression coefficients) are not too small (and have means closer to those expected by the <code>brms</code> default intercept priors).</p>
<p>The reason we do not mean-center and scale <code>VO2</code> and <code>VCO2</code> is that the model below relates them to each other in terms of the respiratory quotient, <code>RQ</code>, which would be more complex if they had been converted to standard deviations.</p>
<pre class="r"><code>scaled_data &lt;- respiration %&gt;%
  mutate(VO2 = VO2 * 1000, 
         VCO2 = VCO2 * 1000,
         BODYMASS = as.numeric(scale(BODYMASS)),
         ACTIVITY = as.numeric(scale(ACTIVITY))) %&gt;% 
  select(-RQ) 

scaled_data %&gt;%
  mutate_if(is.numeric, ~ format(round(.x, 3), nsmall = 3)) %&gt;%
  my_data_table()</code></pre>
<div id="htmlwidget-7906f35e2c2233ddabfe" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7906f35e2c2233ddabfe">{"x":{"filter":"none","extensions":["Scroller","Buttons"],"autoHideNavigation":true,"data":[["Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Mono","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly","Poly"],["F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M"],["M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M1","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M2","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M3","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","M4","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P1","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P2","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P3","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4","P4"],["M1T1F","M1T1F","M1T1F","M1T2F","M1T2F","M1T2F","M1T3F","M1T3F","M1T3F","M1T1M","M1T1M","M1T1M","M1T2M","M1T2M","M1T2M","M1T3M","M1T3M","M1T3M","M2T1F","M2T1F","M2T1F","M2T2F","M2T2F","M2T2F","M2T3F","M2T3F","M2T3F","M2T1M","M2T1M","M2T1M","M2T2M","M2T2M","M2T2M","M2T3M","M2T3M","M2T3M","M3T1F","M3T1F","M3T1F","M3T2F","M3T2F","M3T2F","M3T3F","M3T3F","M3T3F","M3T1M","M3T1M","M3T1M","M3T2M","M3T2M","M3T2M","M3T3M","M3T3M","M3T3M","M4T1F","M4T1F","M4T1F","M4T2F","M4T2F","M4T2F","M4T3F","M4T3F","M4T3F","M4T1M","M4T1M","M4T1M","M4T2M","M4T2M","M4T2M","M4T3M","M4T3M","M4T3M","P1T1F","P1T1F","P1T1F","P1T2F","P1T2F","P1T2F","P1T3F","P1T3F","P1T3F","P1T1M","P1T1M","P1T1M","P1T2M","P1T2M","P1T2M","P1T3M","P1T3M","P1T3M","P2T1F","P2T1F","P2T1F","P2T2F","P2T2F","P2T2F","P2T3F","P2T3F","P2T3F","P2T1M","P2T1M","P2T1M","P2T2M","P2T2M","P2T2M","P2T3M","P2T3M","P2T3M","P3T1F","P3T1F","P3T1F","P3T2F","P3T2F","P3T2F","P3T3F","P3T3F","P3T3F","P3T1M","P3T1M","P3T1M","P3T2M","P3T2M","P3T2M","P3T3M","P3T3M","P3T3M","P4T1F","P4T1F","P4T1F","P4T2F","P4T2F","P4T2F","P4T3F","P4T3F","P4T3F","P4T1M","P4T1M","P4T1M","P4T2M","P4T2M","P4T2M","P4T3M","P4T3M","P4T3M"],["I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III"],[" 6.920"," 6.154"," 4.869"," 6.827"," 6.953"," 4.745"," 6.088"," 4.476"," 4.030"," 6.800"," 5.868"," 3.224"," 8.501"," 5.177"," 4.323"," 7.061"," 4.574"," 2.814"," 6.583"," 7.423"," 6.177","10.361"," 7.142"," 6.389"," 6.320"," 6.898"," 6.373"," 5.295"," 5.690"," 2.927"," 7.189"," 4.844"," 3.186","10.264"," 6.845"," 5.828"," 7.777"," 4.801"," 5.116"," 4.582"," 5.480"," 3.719"," 7.649"," 6.952"," 5.021"," 4.543"," 3.586"," 2.851"," 7.869"," 4.726"," 5.166"," 3.238"," 3.312"," 1.961","10.721"," 6.776"," 8.341","10.721"," 6.776"," 8.341"," 8.449"," 7.242"," 8.416"," 7.189"," 4.844"," 3.186"," 5.180"," 7.192"," 5.388"," 3.253"," 5.291"," 2.293"," 5.433"," 7.363"," 6.494"," 7.887"," 7.151"," 3.548"," 9.066"," 6.581"," 9.250","10.777"," 8.868"," 8.696"," 5.325"," 7.690"," 8.328"," 7.643"," 7.208"," 7.801"," 8.802"," 8.294"," 4.915","11.140","11.956"," 8.614"," 9.198"," 9.948"," 5.939"," 7.533"," 7.927"," 5.668","10.496","11.035"," 7.631"," 9.024"," 6.021"," 5.431"," 5.417"," 4.866"," 3.550"," 7.888"," 6.940"," 6.480"," 8.124"," 6.423"," 5.975"," 7.727"," 5.498"," 4.907"," 7.114"," 4.208"," 4.284"," 8.724"," 7.651"," 5.926"," 7.003"," 5.795"," 6.612","11.001","10.009","10.363","10.197","10.443"," 9.061"," 8.721"," 7.651"," 6.483"," 7.942"," 7.276"," 4.393"," 6.300"," 8.227"," 6.946"],[" 5.499"," 4.908"," 3.365"," 5.766"," 5.341"," 3.636"," 4.781"," 3.533"," 3.254"," 6.677"," 5.260"," 3.445"," 6.868"," 4.435"," 3.039"," 6.502"," 4.585"," 3.060"," 5.456"," 6.211"," 5.431"," 8.093"," 6.131"," 5.415"," 5.728"," 6.083"," 5.014"," 4.699"," 4.702"," 3.085"," 5.778"," 4.131"," 3.174"," 8.290"," 5.651"," 4.340"," 7.381"," 4.496"," 4.868"," 4.419"," 5.290"," 3.595"," 7.836"," 6.181"," 4.422"," 4.097"," 3.998"," 3.130"," 6.977"," 4.621"," 4.050"," 3.779"," 3.869"," 2.812"," 8.570"," 6.729"," 6.636"," 8.570"," 6.729"," 6.636"," 8.908"," 6.232"," 7.534"," 5.778"," 4.131"," 3.174"," 4.697"," 5.331"," 4.693"," 3.771"," 4.681"," 2.996"," 5.206"," 6.227"," 5.798"," 7.251"," 6.598"," 4.467"," 7.552"," 6.287"," 7.580","10.066"," 7.810"," 7.077"," 4.321"," 6.100"," 6.494"," 6.221"," 6.235"," 6.527"," 7.270"," 6.984"," 4.826"," 9.137","10.154"," 7.809"," 7.013"," 7.925"," 5.187"," 6.146"," 7.312"," 4.371","11.759"," 9.855"," 6.747"," 7.345"," 4.728"," 4.805"," 4.975"," 4.851"," 4.175"," 6.709"," 7.079"," 6.579"," 6.580"," 6.011"," 5.175"," 7.397"," 4.907"," 4.105"," 5.997"," 3.517"," 3.644"," 7.183"," 6.301"," 5.500"," 6.941"," 5.910"," 6.124"," 9.439"," 8.903"," 8.473"," 8.292"," 8.586"," 7.913"," 8.157"," 6.802"," 6.138"," 7.272"," 6.153"," 5.331"," 6.032"," 6.717"," 5.998"],["-0.684","-0.827","-1.160","-1.148","-0.894","-1.165","-0.970","-1.095","-1.154"," 0.527"," 0.316","-0.251"," 1.023","-0.414","-1.036","-0.570","-0.877","-1.151","-1.088","-0.919"," 0.092","-0.085"," 0.281","-0.819","-0.964","-0.952","-0.901","-1.092","-1.147","-1.145"," 0.582","-0.703","-0.535"," 0.389","-0.206","-1.032","-0.484","-1.107","-0.081","-1.150"," 0.115"," 0.264","-1.004","-0.219","-0.437","-0.976","-1.167","-0.299","-0.878","-0.580","-1.157","-0.301"," 0.177","-0.135","-1.156","-0.359","-0.997","-1.156","-0.359","-0.997","-1.124","-1.162"," 0.576"," 0.582","-0.703","-0.535","-1.130","-0.821","-0.768","-1.206","-1.207","-1.209","-0.793"," 0.698"," 0.544"," 0.695","-0.991","-0.615"," 0.887"," 0.603"," 1.193"," 0.969"," 0.550"," 0.410","-0.186"," 1.114"," 1.550"," 0.300"," 0.686"," 0.981","-0.278","-0.091","-0.103"," 0.841"," 1.180"," 0.669"," 2.554"," 2.039"," 1.629"," 0.463"," 0.648"," 0.245"," 1.440"," 1.149"," 1.098"," 1.322"," 0.627"," 0.498","-0.963","-1.124","-1.065","-0.014"," 0.753"," 1.073","-0.896"," 0.411"," 0.042"," 0.732"," 0.718","-0.663"," 0.349"," 0.196","-0.117"," 0.695"," 0.570"," 0.728","-1.197","-1.196","-1.193"," 1.616"," 2.313"," 1.680"," 1.850"," 2.729"," 2.579"," 1.250"," 1.671"," 1.597","-0.148"," 0.389"," 1.097"," 0.695"," 1.597"," 1.652"],["-0.103","-0.103","-0.103"," 0.478"," 0.478"," 0.478","-0.241","-0.241","-0.241","-1.430","-1.430","-1.430","-1.154","-1.154","-1.154","-0.656","-0.656","-0.656"," 0.755"," 0.755"," 0.755","-0.352","-0.352","-0.352"," 0.727"," 0.727"," 0.727","-0.933","-0.933","-0.933","-1.154","-1.154","-1.154","-0.601","-0.601","-0.601"," 0.036"," 0.036"," 0.036","-0.213","-0.213","-0.213"," 0.616"," 0.616"," 0.616","-0.269","-0.269","-0.269","-1.099","-1.099","-1.099","-1.430","-1.430","-1.430"," 0.561"," 0.561"," 0.561"," 1.059"," 1.059"," 1.059"," 0.782"," 0.782"," 0.782"," 0.782"," 0.782"," 0.782","-0.462","-0.462","-0.462","-0.047","-0.047","-0.047"," 2.691"," 2.691"," 2.691"," 0.755"," 0.755"," 0.755"," 0.367"," 0.367"," 0.367"," 1.114"," 1.114"," 1.114"," 0.229"," 0.229"," 0.229","-0.241","-0.241","-0.241"," 0.174"," 0.174"," 0.174"," 0.589"," 0.589"," 0.589","-0.656","-0.656","-0.656","-0.960","-0.960","-0.960","-1.154","-1.154","-1.154","-0.684","-0.684","-0.684"," 1.916"," 1.916"," 1.916"," 2.359"," 2.359"," 2.359"," 1.529"," 1.529"," 1.529","-0.703","-0.703","-0.703","-1.237","-1.237","-1.237","-0.186","-0.186","-0.186","-0.794","-0.794","-0.794"," 1.308"," 1.308"," 1.308"," 1.031"," 1.031"," 1.031","-1.071","-1.071","-1.071","-0.822","-0.822","-0.822","-1.209","-1.209","-1.209"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>SELECTION<\/th>\n      <th>SEX<\/th>\n      <th>LINE<\/th>\n      <th>SAMPLE<\/th>\n      <th>CYCLE<\/th>\n      <th>VO2<\/th>\n      <th>VCO2<\/th>\n      <th>ACTIVITY<\/th>\n      <th>BODYMASS<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","deferRender":true,"scrollX":true,"scrollY":400,"scrollCollapse":true,"buttons":["csv",{"extend":"pdf","pageSize":"A4","orientation":"landscape","filename":"Dpseudo_respiration"}],"pageLength":50,"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="define-the-sems-sub-models" class="section level3">
<h3>Define the SEM’s sub-models</h3>
<p>Here, we write out all the formulae of the sub-models in the SEM. There is a sub-model for oxygen consumption (<code>VO2</code>) and another for <code>CO2</code> production (<code>VCO2</code>) which depends on the parameter <code>RQ</code> (the respiratory quotient, i.e. <code>VCO2</code> / <code>VO2</code>); there are also sub-models for body mass (<code>BODYMASS</code>) and activity level (<code>ACTIVITY</code>).</p>
<p>In short, we assume that <code>VO2</code>, <code>RQ</code>, <code>BODYMASS</code>, and <code>ACTIVITY</code> are affected by the predictor variables related to the experimental design. These variables are <code>SELECTION</code> (i.e. M vs P treatment), <code>SEX</code> (Male or Female), <code>CYCLE</code> (I, II, or III: this refers to the first, second, and third measurement of O2 and CO2 for each triad of flies), <code>LINE</code> (8 levels, one for each of the four independent replicates of the M an P treatments), and <code>SAMPLE</code> (a random intercept that groups the three replicate measures of each triad of flies across the three cycles). Unlike the other response variables, <code>VCO2</code> is predicted from the estimated values of <code>VO2</code> and <code>RQ</code> as <code>VO2</code> <code>RQ</code>, and thus is related to the predictor variables only indirectly (the choice to make <code>VCO2</code> dependent rather than <code>VO2</code> dependant on <code>RQ</code> is arbitrary, and does not affect the results).</p>
<p>The <code>brms</code> notation for the line random effects (<code>(SELECTION | p | LINE)</code>) means that the model fits a random intercept for each of the 8 lines, and that these random intercepts are (potentially) correlated across each of the response variables. Furthermore, the model fits a random slope for <code>SELECTION</code>, which allows the treatment effect to vary across the replicate lines.</p>
<div id="vo2" class="section level4">
<h4>VO2</h4>
<p>Formula: <code>VO2 ~ SELECTION * SEX * CYCLE + BODYMASS + ACTIVITY + (SELECTION | p | LINE) + (1 | SAMPLE)</code></p>
<p>This formula allows for effects on <code>VO2</code> of sex, selection and cycle (and all 2- and 3-way interactions). The model also allows for linear effects of <code>BODYMASS</code> and <code>ACTIVITY</code> on <code>VO2</code>. Furthermore the model assumes there may be variation in <code>VO2</code> within and between each triad of flies, and between each replicate selection line (preventing pseudo-replication by properly accounting for our experimental design).</p>
</div>
<div id="vco2-as-determined-by-the-estimated-parameter-rq" class="section level4">
<h4>VCO2 (as determined by the estimated parameter RQ)</h4>
<p>Formulae (2-part model, see <code>vignette("brms_nonlinear")</code>):</p>
<p><code>VCO2 ~ VO2 * (0.7 + 0.3 * inv_logit(RQ))</code></p>
<p><code>RQ ~ SELECTION * SEX * CYCLE + BODYMASS + ACTIVITY + (SELECTION | p | LINE) + (1 | SAMPLE)</code></p>
<p><code>VCO2</code> is assumed to depend on the value of <code>VO2</code> from the same measurement, multiplied by <code>RQ</code>. We use a modified inverse logit function that forces <code>RQ</code> to lie 0.7 and 1 (this must be the case, given the chemistry of respiration, and building this information into the model should yield more precise estimates of the model’s parameters). In turn, <code>RQ</code> is predicted by the same set of predictors as for <code>VO2</code>.</p>
</div>
<div id="body-mass" class="section level4">
<h4>Body mass</h4>
<p><code>BODYMASS | subset(body_subset) ~ SELECTION * SEX + (SELECTION | p | LINE)</code></p>
<p>The model fits the selection line treatment and sex as fixed effects, as well as the random intercept for line. There is not <code>SAMPLE</code> random effect, since the body mass of each triad of flies was measured only once (unlike for the other response variables, which were each measured 3 times). The notation <code>subset(body_subset)</code> instructs <code>brms</code> to fit this model using only a sub-set of the data, because unfortunately the body mass data was not collected for every triad of flies due to an experimental error (leaving our the <code>subset</code> term would discard all rows of the data for which body size was not measured, wasting the data for the other response variables).</p>
</div>
<div id="activity-level" class="section level4">
<h4>Activity level</h4>
<p><code>ACTIVITY ~ SELECTION * SEX * CYCLE + (SELECTION | p | LINE) + (1 | SAMPLE)</code></p>
<p>The model fits the selection line treatment and sex as fixed effects, as well as crossed random intercepts for line and sample.</p>
<pre class="r"><code>brms_data &lt;- scaled_data %&gt;%
  mutate(body_subset = CYCLE == &quot;I&quot;)    

brms_formula &lt;- 
  bf(VO2 ~ SELECTION * SEX * CYCLE +  # VO2 sub-model
       BODYMASS + ACTIVITY +  
       (SELECTION | p | LINE) + (1 | SAMPLE)) +
  
  bf(VCO2 ~ VO2 * (0.7 + 0.3 * inv_logit(RQ)),   # VCO2 and RQ sub-models
     RQ ~ SELECTION * SEX * CYCLE + 
       BODYMASS + ACTIVITY + 
       (SELECTION | p | LINE) + (1 | SAMPLE),
     nl = TRUE) +
  
  bf(BODYMASS | subset(body_subset) ~ SELECTION * SEX + # body mass sub-model
       (SELECTION | p | LINE)) +
  
  bf(ACTIVITY ~ SELECTION * SEX * CYCLE +   # activity sub-model
       (SELECTION | p | LINE) + (1 | SAMPLE)) +  
  
  set_rescor(FALSE) # cannot estimate residual correlations when using the subset() argument

brms_formula</code></pre>
<pre>VO2 ~ SELECTION * SEX * CYCLE + BODYMASS + ACTIVITY + (SELECTION | p | LINE) + (1 | SAMPLE) 
VCO2 ~ VO2 * (0.7 + 0.3 * inv_logit(RQ)) 
RQ ~ SELECTION * SEX * CYCLE + BODYMASS + ACTIVITY + (SELECTION | p | LINE) + (1 | SAMPLE)
BODYMASS | subset(body_subset) ~ SELECTION * SEX + (SELECTION | p | LINE) 
ACTIVITY ~ SELECTION * SEX * CYCLE + (SELECTION | p | LINE) + (1 | SAMPLE) 
</pre>
</div>
</div>
<div id="define-priors" class="section level3">
<h3>Define Priors</h3>
<p>We use set fairly tight Normal priors on all fixed effect parameters, which ‘regularises’ the estimates towards zero – this is conservative (because it ensures that a stronger signal in the data is needed to produce a given posterior effect size estimate), and it also helps the model to converge. Similarly, we set a somewhat conservative half-Cauchy prior (mean 0, scale 0.1) on the random effects for <code>LINE</code> (i.e. we consider large differences between lines – in terms of means and treatment effects – to be possible but improbable). We leave all other priors at the defaults used by <code>brms</code>. Note that the Normal priors are slightly wider in the model of dry weight, because we expect larger effect sizes of sex and treatment on dry weight than on the metabolite composition.</p>
<pre class="r"><code>prior_SEM &lt;- c(set_prior(&quot;normal(0, 1)&quot;, class = &quot;b&quot;, resp = &#39;VO2&#39;),
            set_prior(&quot;normal(0, 1)&quot;, class = &quot;b&quot;, resp = &quot;VCO2&quot;, nlpar = &quot;RQ&quot;),
            set_prior(&quot;normal(0, 1)&quot;, class = &quot;b&quot;, resp = &quot;BODYMASS&quot;),
            set_prior(&quot;normal(0, 1)&quot;, class = &quot;b&quot;, resp = &quot;ACTIVITY&quot;),
            
            set_prior(&quot;cauchy(0, 0.1)&quot;, class = &quot;sd&quot;, resp = &#39;VO2&#39;, group = &quot;LINE&quot;),
            set_prior(&quot;cauchy(0, 0.1)&quot;, class = &quot;sd&quot;, resp = &quot;VCO2&quot;, nlpar = &quot;RQ&quot;, group = &quot;LINE&quot;),
            set_prior(&quot;cauchy(0, 0.1)&quot;, class = &quot;sd&quot;, resp = &#39;VO2&#39;, group = &quot;SAMPLE&quot;),
            set_prior(&quot;cauchy(0, 0.1)&quot;, class = &quot;sd&quot;, resp = &quot;VCO2&quot;, nlpar = &quot;RQ&quot;, group = &quot;SAMPLE&quot;),
            set_prior(&quot;cauchy(0, 0.1)&quot;, class = &quot;sd&quot;, resp = &#39;BODYMASS&#39;, group = &quot;LINE&quot;),
            set_prior(&quot;cauchy(0, 0.1)&quot;, class = &quot;sd&quot;, resp = &#39;ACTIVITY&#39;, group = &quot;LINE&quot;),
            set_prior(&quot;cauchy(0, 0.1)&quot;, class = &quot;sd&quot;, resp = &#39;ACTIVITY&#39;, group = &quot;SAMPLE&quot;))

prior_SEM</code></pre>
<pre>          prior class coef  group     resp dpar nlpar bound source
   normal(0, 1)     b                  VO2                    user
   normal(0, 1)     b                 VCO2         RQ         user
   normal(0, 1)     b             BODYMASS                    user
   normal(0, 1)     b             ACTIVITY                    user
 cauchy(0, 0.1)    sd        LINE      VO2                    user
 cauchy(0, 0.1)    sd        LINE     VCO2         RQ         user
 cauchy(0, 0.1)    sd      SAMPLE      VO2                    user
 cauchy(0, 0.1)    sd      SAMPLE     VCO2         RQ         user
 cauchy(0, 0.1)    sd        LINE BODYMASS                    user
 cauchy(0, 0.1)    sd        LINE ACTIVITY                    user
 cauchy(0, 0.1)    sd      SAMPLE ACTIVITY                    user
</pre>
</div>
<div id="run-the-model" class="section level3">
<h3>Run the model</h3>
<p>The model is run over 4 chains with 7000 iterations each (with the first 3500 discarded as burn-in), for a total of 3500*4 = 14,000 posterior samples.</p>
<pre class="r"><code>if(!file.exists(&quot;output/brms_SEM_respiration.rds&quot;)){
  brms_SEM_respiration &lt;- brm(
    brms_formula, 
    data = brms_data, 
    iter = 7000, chains = 4, cores = 1,
    prior = prior_SEM,
    control = list(max_treedepth = 20, adapt_delta = 0.99))
  
  saveRDS(brms_SEM_respiration, &quot;output/brms_SEM_respiration.rds&quot;)
} else brms_SEM_respiration &lt;- readRDS(&quot;output/brms_SEM_respiration.rds&quot;)</code></pre>
</div>
<div id="posterior-predictive-check-of-model-fit" class="section level3">
<h3>Posterior predictive check of model fit</h3>
<p>The plot below shows that the fitted model is able to produce posterior predictions that have a similar distribution to the original data, for each of the response variables, which is a necessary condition for the model to be used for statistical inference. Note that the fit produces less accurate predictions for body mass, reflecting the smaller number of data points for this response variable.</p>
<pre class="r"><code>grid.arrange(
  pp_check(brms_SEM_respiration, resp = &quot;VO2&quot;) + 
    ggtitle(&quot;VO2&quot;) + theme(legend.position = &quot;none&quot;),
  pp_check(brms_SEM_respiration, resp = &quot;VCO2&quot;) + 
    ggtitle(&quot;VCO2&quot;) + theme(legend.position = &quot;none&quot;),
  pp_check(brms_SEM_respiration, resp = &quot;BODYMASS&quot;) + 
    ggtitle(&quot;Body mass&quot;) + theme(legend.position = &quot;none&quot;),
  pp_check(brms_SEM_respiration, resp = &quot;ACTIVITY&quot;) + 
    ggtitle(&quot;Activity level&quot;) + theme(legend.position = &quot;none&quot;),
  nrow = 1
)</code></pre>
<p><img src="figure/respirometry.Rmd/unnamed-chunk-14-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-14-1">
Past versions of unnamed-chunk-14-1.png
</button>
</p>
<div id="fig-unnamed-chunk-14-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/2791e70bfba58cbb5318dbbb6a52cb0c9bbccdef/docs/figure/respirometry.Rmd/unnamed-chunk-14-1.png" target="_blank">2791e70</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/a14c3784a106e71d73e04484412547fc29aa1d82/docs/figure/respirometry.Rmd/unnamed-chunk-14-1.png" target="_blank">a14c378</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/2fc158d6b5ce97ffbdd73c6cd7a9b4b9ef14e28f/docs/figure/respirometry.Rmd/unnamed-chunk-14-1.png" target="_blank">2fc158d</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="table-of-model-parameter-estimates" class="section level2 tabset">
<h2>Table of model parameter estimates</h2>
<div id="formatted-table" class="section level3">
<h3>Formatted table</h3>
<p>This tables shows the fixed effects estimates for the treatment, sex, their interaction, as well as the slope associated with dry weight (where relevant), for each of the six response variables. The <code>p</code> column shows 1 - minus the “probability of direction”, i.e. the posterior probability that the reported sign of the estimate is correct given the data and the prior; subtracting this value from one gives a Bayesian equivalent of a one-sided p-value. For brevity, we have omitted all the parameter estimates involving the predictor variable <code>line</code>, as well as the estimates of residual (co)variance. Click the next tab to see a complete summary of the model and its output.</p>
<pre class="r"><code>hypSEM &lt;- left_join(
  fixef(brms_SEM_respiration) %&gt;% as.data.frame() %&gt;% rownames_to_column(&quot;Parameter&quot;),
  bayestestR::p_direction(brms_SEM_respiration) %&gt;% as.data.frame() %&gt;% select(Parameter, pd) %&gt;%
  mutate(Parameter = str_remove_all(Parameter, &quot;b_&quot;), Parameter = str_replace_all(Parameter, &quot;[.]&quot;, &quot;:&quot;)), 
  by = &quot;Parameter&quot;
) %&gt;% mutate(Response = map_chr(str_split(Parameter, &quot;_&quot;), ~ .x[1]),
             Parameter = map(str_split(Parameter, &quot;_&quot;), ~ .x[length(.x)]),
             pd = 1 - pd) %&gt;%
  select(Response, Parameter, everything()) %&gt;% 
  rename(p = pd) %&gt;%
  mutate(Parameter = str_replace_all(Parameter, &quot;SELECTIONPoly&quot;, &quot;Treatment (P)&quot;),
         Parameter = str_replace_all(Parameter, &quot;SEXM&quot;, &quot;Sex (M)&quot;),
         Parameter = str_replace_all(Parameter, &quot;BODYMASS&quot;, &quot;Body weight&quot;),
         Parameter = str_replace_all(Parameter, &quot;ACTIVITY&quot;, &quot;Activity level&quot;),
         Parameter = str_replace_all(Parameter, &quot;CYCLEIII&quot;, &quot;Cycle (III)&quot;),
         Parameter = str_replace_all(Parameter, &quot;CYCLEII&quot;, &quot;Cycle (II)&quot;),
         Parameter = str_replace_all(Parameter, &quot;:&quot;, &quot; x &quot;)) %&gt;%
  mutate(Response = str_replace_all(Response, &quot;BODYMASS&quot;, &quot;Body weight&quot;),
         Response = str_replace_all(Response, &quot;ACTIVITY&quot;, &quot;Activity level&quot;),
         Response = str_replace_all(Response, &quot;VCO2&quot;, &quot;Respiratory quotient (RQ)&quot;),
         Response = factor(Response, c(&quot;VO2&quot;, &quot;Respiratory quotient (RQ)&quot;, &quot;Activity level&quot;, &quot;Body weight&quot;))) %&gt;%
  mutate(` ` = ifelse(p &lt; 0.05, &quot;\\*&quot;, &quot;&quot;)) %&gt;%
  distinct() %&gt;%
  arrange(Response) %&gt;%
  select(-Response)

hypSEM  %&gt;% 
  kable(digits = 3) %&gt;% 
  kable_styling(full_width = FALSE) %&gt;%
  group_rows(&quot;Oxygen consumption (VO2)&quot;, 1, 14) %&gt;%
  group_rows(&quot;Respiratory quotient (RQ)&quot;, 15, 28) %&gt;%
  group_rows(&quot;Activity level&quot;, 29, 40) %&gt;%
  group_rows(&quot;Body weight&quot;, 41, 44) </code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Est.Error
</th>
<th style="text-align:right;">
Q2.5
</th>
<th style="text-align:right;">
Q97.5
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr grouplength="14">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>Oxygen consumption (VO2)</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Intercept
</td>
<td style="text-align:right;">
8.047
</td>
<td style="text-align:right;">
0.411
</td>
<td style="text-align:right;">
7.231
</td>
<td style="text-align:right;">
8.851
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P)
</td>
<td style="text-align:right;">
-0.139
</td>
<td style="text-align:right;">
0.523
</td>
<td style="text-align:right;">
-1.135
</td>
<td style="text-align:right;">
0.905
</td>
<td style="text-align:right;">
0.389
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Sex (M)
</td>
<td style="text-align:right;">
-1.009
</td>
<td style="text-align:right;">
0.490
</td>
<td style="text-align:right;">
-1.967
</td>
<td style="text-align:right;">
-0.046
</td>
<td style="text-align:right;">
0.021
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Cycle (II)
</td>
<td style="text-align:right;">
-1.103
</td>
<td style="text-align:right;">
0.336
</td>
<td style="text-align:right;">
-1.754
</td>
<td style="text-align:right;">
-0.433
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Cycle (III)
</td>
<td style="text-align:right;">
-1.727
</td>
<td style="text-align:right;">
0.332
</td>
<td style="text-align:right;">
-2.361
</td>
<td style="text-align:right;">
-1.073
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body weight
</td>
<td style="text-align:right;">
0.300
</td>
<td style="text-align:right;">
0.235
</td>
<td style="text-align:right;">
-0.164
</td>
<td style="text-align:right;">
0.772
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity level
</td>
<td style="text-align:right;">
1.006
</td>
<td style="text-align:right;">
0.166
</td>
<td style="text-align:right;">
0.677
</td>
<td style="text-align:right;">
1.332
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Sex (M)
</td>
<td style="text-align:right;">
0.647
</td>
<td style="text-align:right;">
0.564
</td>
<td style="text-align:right;">
-0.471
</td>
<td style="text-align:right;">
1.737
</td>
<td style="text-align:right;">
0.125
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Cycle (II)
</td>
<td style="text-align:right;">
0.309
</td>
<td style="text-align:right;">
0.442
</td>
<td style="text-align:right;">
-0.563
</td>
<td style="text-align:right;">
1.180
</td>
<td style="text-align:right;">
0.243
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Cycle (III)
</td>
<td style="text-align:right;">
-0.135
</td>
<td style="text-align:right;">
0.429
</td>
<td style="text-align:right;">
-0.974
</td>
<td style="text-align:right;">
0.717
</td>
<td style="text-align:right;">
0.380
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Sex (M) x Cycle (II)
</td>
<td style="text-align:right;">
0.152
</td>
<td style="text-align:right;">
0.441
</td>
<td style="text-align:right;">
-0.721
</td>
<td style="text-align:right;">
1.005
</td>
<td style="text-align:right;">
0.367
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Sex (M) x Cycle (III)
</td>
<td style="text-align:right;">
-0.507
</td>
<td style="text-align:right;">
0.442
</td>
<td style="text-align:right;">
-1.376
</td>
<td style="text-align:right;">
0.365
</td>
<td style="text-align:right;">
0.127
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Sex (M) x Cycle (II)
</td>
<td style="text-align:right;">
-0.160
</td>
<td style="text-align:right;">
0.561
</td>
<td style="text-align:right;">
-1.265
</td>
<td style="text-align:right;">
0.940
</td>
<td style="text-align:right;">
0.389
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Sex (M) x Cycle (III)
</td>
<td style="text-align:right;">
0.514
</td>
<td style="text-align:right;">
0.559
</td>
<td style="text-align:right;">
-0.591
</td>
<td style="text-align:right;">
1.609
</td>
<td style="text-align:right;">
0.176
</td>
<td style="text-align:left;">
</td>
</tr>
<tr grouplength="14">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>Respiratory quotient (RQ)</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Intercept
</td>
<td style="text-align:right;">
-0.008
</td>
<td style="text-align:right;">
0.321
</td>
<td style="text-align:right;">
-0.618
</td>
<td style="text-align:right;">
0.636
</td>
<td style="text-align:right;">
0.484
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P)
</td>
<td style="text-align:right;">
0.297
</td>
<td style="text-align:right;">
0.447
</td>
<td style="text-align:right;">
-0.588
</td>
<td style="text-align:right;">
1.181
</td>
<td style="text-align:right;">
0.247
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Sex (M)
</td>
<td style="text-align:right;">
0.480
</td>
<td style="text-align:right;">
0.429
</td>
<td style="text-align:right;">
-0.357
</td>
<td style="text-align:right;">
1.336
</td>
<td style="text-align:right;">
0.130
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Cycle (II)
</td>
<td style="text-align:right;">
0.394
</td>
<td style="text-align:right;">
0.378
</td>
<td style="text-align:right;">
-0.340
</td>
<td style="text-align:right;">
1.155
</td>
<td style="text-align:right;">
0.146
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Cycle (III)
</td>
<td style="text-align:right;">
-0.107
</td>
<td style="text-align:right;">
0.379
</td>
<td style="text-align:right;">
-0.848
</td>
<td style="text-align:right;">
0.648
</td>
<td style="text-align:right;">
0.387
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body weight
</td>
<td style="text-align:right;">
-0.013
</td>
<td style="text-align:right;">
0.182
</td>
<td style="text-align:right;">
-0.374
</td>
<td style="text-align:right;">
0.349
</td>
<td style="text-align:right;">
0.472
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity level
</td>
<td style="text-align:right;">
-0.224
</td>
<td style="text-align:right;">
0.155
</td>
<td style="text-align:right;">
-0.528
</td>
<td style="text-align:right;">
0.084
</td>
<td style="text-align:right;">
0.073
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Sex (M)
</td>
<td style="text-align:right;">
0.134
</td>
<td style="text-align:right;">
0.502
</td>
<td style="text-align:right;">
-0.870
</td>
<td style="text-align:right;">
1.098
</td>
<td style="text-align:right;">
0.388
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Cycle (II)
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
0.456
</td>
<td style="text-align:right;">
-0.883
</td>
<td style="text-align:right;">
0.924
</td>
<td style="text-align:right;">
0.474
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Cycle (III)
</td>
<td style="text-align:right;">
0.571
</td>
<td style="text-align:right;">
0.480
</td>
<td style="text-align:right;">
-0.375
</td>
<td style="text-align:right;">
1.523
</td>
<td style="text-align:right;">
0.115
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Sex (M) x Cycle (II)
</td>
<td style="text-align:right;">
-0.528
</td>
<td style="text-align:right;">
0.521
</td>
<td style="text-align:right;">
-1.549
</td>
<td style="text-align:right;">
0.499
</td>
<td style="text-align:right;">
0.154
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Sex (M) x Cycle (III)
</td>
<td style="text-align:right;">
-0.029
</td>
<td style="text-align:right;">
0.574
</td>
<td style="text-align:right;">
-1.164
</td>
<td style="text-align:right;">
1.104
</td>
<td style="text-align:right;">
0.480
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Sex (M) x Cycle (II)
</td>
<td style="text-align:right;">
-0.467
</td>
<td style="text-align:right;">
0.606
</td>
<td style="text-align:right;">
-1.667
</td>
<td style="text-align:right;">
0.725
</td>
<td style="text-align:right;">
0.220
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Sex (M) x Cycle (III)
</td>
<td style="text-align:right;">
-0.815
</td>
<td style="text-align:right;">
0.652
</td>
<td style="text-align:right;">
-2.084
</td>
<td style="text-align:right;">
0.466
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:left;">
</td>
</tr>
<tr grouplength="12">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>Activity level</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Intercept
</td>
<td style="text-align:right;">
-0.780
</td>
<td style="text-align:right;">
0.218
</td>
<td style="text-align:right;">
-1.210
</td>
<td style="text-align:right;">
-0.339
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P)
</td>
<td style="text-align:right;">
1.047
</td>
<td style="text-align:right;">
0.319
</td>
<td style="text-align:right;">
0.421
</td>
<td style="text-align:right;">
1.669
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Sex (M)
</td>
<td style="text-align:right;">
0.457
</td>
<td style="text-align:right;">
0.283
</td>
<td style="text-align:right;">
-0.101
</td>
<td style="text-align:right;">
1.008
</td>
<td style="text-align:right;">
0.055
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Cycle (II)
</td>
<td style="text-align:right;">
0.192
</td>
<td style="text-align:right;">
0.186
</td>
<td style="text-align:right;">
-0.173
</td>
<td style="text-align:right;">
0.555
</td>
<td style="text-align:right;">
0.149
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Cycle (III)
</td>
<td style="text-align:right;">
0.238
</td>
<td style="text-align:right;">
0.188
</td>
<td style="text-align:right;">
-0.130
</td>
<td style="text-align:right;">
0.607
</td>
<td style="text-align:right;">
0.103
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Sex (M)
</td>
<td style="text-align:right;">
-0.065
</td>
<td style="text-align:right;">
0.383
</td>
<td style="text-align:right;">
-0.810
</td>
<td style="text-align:right;">
0.692
</td>
<td style="text-align:right;">
0.432
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Cycle (II)
</td>
<td style="text-align:right;">
0.104
</td>
<td style="text-align:right;">
0.259
</td>
<td style="text-align:right;">
-0.397
</td>
<td style="text-align:right;">
0.620
</td>
<td style="text-align:right;">
0.346
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Cycle (III)
</td>
<td style="text-align:right;">
-0.012
</td>
<td style="text-align:right;">
0.259
</td>
<td style="text-align:right;">
-0.512
</td>
<td style="text-align:right;">
0.497
</td>
<td style="text-align:right;">
0.479
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Sex (M) x Cycle (II)
</td>
<td style="text-align:right;">
-0.480
</td>
<td style="text-align:right;">
0.258
</td>
<td style="text-align:right;">
-0.989
</td>
<td style="text-align:right;">
0.027
</td>
<td style="text-align:right;">
0.031
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Sex (M) x Cycle (III)
</td>
<td style="text-align:right;">
-0.676
</td>
<td style="text-align:right;">
0.258
</td>
<td style="text-align:right;">
-1.185
</td>
<td style="text-align:right;">
-0.161
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Sex (M) x Cycle (II)
</td>
<td style="text-align:right;">
0.325
</td>
<td style="text-align:right;">
0.351
</td>
<td style="text-align:right;">
-0.364
</td>
<td style="text-align:right;">
1.010
</td>
<td style="text-align:right;">
0.179
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Sex (M) x Cycle (III)
</td>
<td style="text-align:right;">
0.519
</td>
<td style="text-align:right;">
0.352
</td>
<td style="text-align:right;">
-0.166
</td>
<td style="text-align:right;">
1.198
</td>
<td style="text-align:right;">
0.072
</td>
<td style="text-align:left;">
</td>
</tr>
<tr grouplength="4">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>Body weight</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Intercept
</td>
<td style="text-align:right;">
0.348
</td>
<td style="text-align:right;">
0.250
</td>
<td style="text-align:right;">
-0.145
</td>
<td style="text-align:right;">
0.846
</td>
<td style="text-align:right;">
0.073
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P)
</td>
<td style="text-align:right;">
0.526
</td>
<td style="text-align:right;">
0.378
</td>
<td style="text-align:right;">
-0.234
</td>
<td style="text-align:right;">
1.253
</td>
<td style="text-align:right;">
0.078
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Sex (M)
</td>
<td style="text-align:right;">
-1.019
</td>
<td style="text-align:right;">
0.256
</td>
<td style="text-align:right;">
-1.521
</td>
<td style="text-align:right;">
-0.508
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Treatment (P) x Sex (M)
</td>
<td style="text-align:right;">
-0.444
</td>
<td style="text-align:right;">
0.353
</td>
<td style="text-align:right;">
-1.136
</td>
<td style="text-align:right;">
0.258
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
</div>
<div id="complete-output-from-summary.brmsfit" class="section level3">
<h3>Complete output from <code>summary.brmsfit()</code></h3>
<ul>
<li>‘Group-Level Effects’ (also called random effects): This shows the (co)variances associated with the line-specific intercepts (which have names like <code>sd(VO2_Intercept)</code>) and slopes (e.g. <code>sd(VO2_SELECTIONPoly)</code>), as well as the correlations between these effects (e.g. <code>cor(VO2_Intercept,VO2_SELECTIONPoly)</code>.</li>
<li>‘Population-Level Effects:’ (also called fixed effects): These give the estimates of the intercept (i.e. for female M flies, in Cycle I) and the effects of treatment, sex, dry weight, and the various interaction terms, for each response variable.</li>
<li>‘Family Specific Parameters’: This is the parameter sigma for the residual variance for each response variable</li>
</ul>
<p>Note that the model has converged (Rhat = 1) and the posterior is adequately samples (high ESS values).</p>
<pre class="r"><code>brms_SEM_respiration</code></pre>
<pre> Family: MV(gaussian, gaussian, gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity
         mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: VO2 ~ SELECTION * SEX * CYCLE + BODYMASS + ACTIVITY + (SELECTION | p | LINE) + (1 | SAMPLE) 
         VCO2 ~ VO2 * (0.7 + 0.3 * inv_logit(RQ)) 
         RQ ~ SELECTION * SEX * CYCLE + BODYMASS + ACTIVITY + (SELECTION | p | LINE) + (1 | SAMPLE)
         BODYMASS | subset(body_subset) ~ SELECTION * SEX + (SELECTION | p | LINE) 
         ACTIVITY ~ SELECTION * SEX * CYCLE + (SELECTION | p | LINE) + (1 | SAMPLE) 
   Data: brms_data (Number of observations: 144) 
Samples: 4 chains, each with iter = 7000; warmup = 3500; thin = 1;
         total post-warmup samples = 14000

Group-Level Effects: 
~LINE (Number of levels: 8) 
                                                   Estimate Est.Error l-95% CI
sd(VO2_Intercept)                                      0.28      0.26     0.01
sd(VO2_SELECTIONPoly)                                  0.19      0.26     0.00
sd(VCO2_RQ_Intercept)                                  0.26      0.24     0.01
sd(VCO2_RQ_SELECTIONPoly)                              0.12      0.15     0.00
sd(BODYMASS_Intercept)                                 0.28      0.22     0.01
sd(BODYMASS_SELECTIONPoly)                             0.28      0.30     0.01
sd(ACTIVITY_Intercept)                                 0.10      0.10     0.00
sd(ACTIVITY_SELECTIONPoly)                             0.19      0.22     0.01
cor(VO2_Intercept,VO2_SELECTIONPoly)                   0.00      0.34    -0.64
cor(VO2_Intercept,VCO2_RQ_Intercept)                  -0.09      0.33    -0.67
cor(VO2_SELECTIONPoly,VCO2_RQ_Intercept)              -0.01      0.33    -0.64
cor(VO2_Intercept,VCO2_RQ_SELECTIONPoly)              -0.01      0.33    -0.64
cor(VO2_SELECTIONPoly,VCO2_RQ_SELECTIONPoly)          -0.00      0.33    -0.63
cor(VCO2_RQ_Intercept,VCO2_RQ_SELECTIONPoly)          -0.02      0.33    -0.65
cor(VO2_Intercept,BODYMASS_Intercept)                  0.01      0.33    -0.62
cor(VO2_SELECTIONPoly,BODYMASS_Intercept)             -0.05      0.33    -0.67
cor(VCO2_RQ_Intercept,BODYMASS_Intercept)             -0.01      0.32    -0.62
cor(VCO2_RQ_SELECTIONPoly,BODYMASS_Intercept)         -0.01      0.34    -0.63
cor(VO2_Intercept,BODYMASS_SELECTIONPoly)             -0.05      0.33    -0.65
cor(VO2_SELECTIONPoly,BODYMASS_SELECTIONPoly)         -0.04      0.33    -0.66
cor(VCO2_RQ_Intercept,BODYMASS_SELECTIONPoly)         -0.01      0.33    -0.63
cor(VCO2_RQ_SELECTIONPoly,BODYMASS_SELECTIONPoly)     -0.00      0.33    -0.63
cor(BODYMASS_Intercept,BODYMASS_SELECTIONPoly)         0.02      0.33    -0.61
cor(VO2_Intercept,ACTIVITY_Intercept)                  0.02      0.33    -0.62
cor(VO2_SELECTIONPoly,ACTIVITY_Intercept)              0.03      0.33    -0.61
cor(VCO2_RQ_Intercept,ACTIVITY_Intercept)              0.01      0.33    -0.62
cor(VCO2_RQ_SELECTIONPoly,ACTIVITY_Intercept)         -0.00      0.33    -0.63
cor(BODYMASS_Intercept,ACTIVITY_Intercept)            -0.07      0.33    -0.68
cor(BODYMASS_SELECTIONPoly,ACTIVITY_Intercept)        -0.05      0.33    -0.66
cor(VO2_Intercept,ACTIVITY_SELECTIONPoly)              0.05      0.34    -0.60
cor(VO2_SELECTIONPoly,ACTIVITY_SELECTIONPoly)          0.04      0.34    -0.61
cor(VCO2_RQ_Intercept,ACTIVITY_SELECTIONPoly)          0.00      0.33    -0.62
cor(VCO2_RQ_SELECTIONPoly,ACTIVITY_SELECTIONPoly)     -0.00      0.33    -0.64
cor(BODYMASS_Intercept,ACTIVITY_SELECTIONPoly)        -0.07      0.33    -0.68
cor(BODYMASS_SELECTIONPoly,ACTIVITY_SELECTIONPoly)    -0.06      0.33    -0.68
cor(ACTIVITY_Intercept,ACTIVITY_SELECTIONPoly)         0.01      0.33    -0.63
                                                   u-95% CI Rhat Bulk_ESS
sd(VO2_Intercept)                                      0.93 1.00     2908
sd(VO2_SELECTIONPoly)                                  0.90 1.00     7982
sd(VCO2_RQ_Intercept)                                  0.87 1.00     4358
sd(VCO2_RQ_SELECTIONPoly)                              0.50 1.00    15911
sd(BODYMASS_Intercept)                                 0.78 1.00     3783
sd(BODYMASS_SELECTIONPoly)                             1.04 1.00     5497
sd(ACTIVITY_Intercept)                                 0.36 1.00     6088
sd(ACTIVITY_SELECTIONPoly)                             0.72 1.00     4457
cor(VO2_Intercept,VO2_SELECTIONPoly)                   0.64 1.00    23872
cor(VO2_Intercept,VCO2_RQ_Intercept)                   0.56 1.00    14640
cor(VO2_SELECTIONPoly,VCO2_RQ_Intercept)               0.63 1.00    16067
cor(VO2_Intercept,VCO2_RQ_SELECTIONPoly)               0.63 1.00    30262
cor(VO2_SELECTIONPoly,VCO2_RQ_SELECTIONPoly)           0.64 1.00    21055
cor(VCO2_RQ_Intercept,VCO2_RQ_SELECTIONPoly)           0.62 1.00    17538
cor(VO2_Intercept,BODYMASS_Intercept)                  0.63 1.00    14647
cor(VO2_SELECTIONPoly,BODYMASS_Intercept)              0.60 1.00    12858
cor(VCO2_RQ_Intercept,BODYMASS_Intercept)              0.60 1.00    13404
cor(VCO2_RQ_SELECTIONPoly,BODYMASS_Intercept)          0.63 1.00    11628
cor(VO2_Intercept,BODYMASS_SELECTIONPoly)              0.60 1.00    20255
cor(VO2_SELECTIONPoly,BODYMASS_SELECTIONPoly)          0.61 1.00    15756
cor(VCO2_RQ_Intercept,BODYMASS_SELECTIONPoly)          0.62 1.00    15543
cor(VCO2_RQ_SELECTIONPoly,BODYMASS_SELECTIONPoly)      0.63 1.00    12527
cor(BODYMASS_Intercept,BODYMASS_SELECTIONPoly)         0.65 1.00    13003
cor(VO2_Intercept,ACTIVITY_Intercept)                  0.65 1.00    19840
cor(VO2_SELECTIONPoly,ACTIVITY_Intercept)              0.65 1.00    15524
cor(VCO2_RQ_Intercept,ACTIVITY_Intercept)              0.63 1.00    15534
cor(VCO2_RQ_SELECTIONPoly,ACTIVITY_Intercept)          0.63 1.00    12246
cor(BODYMASS_Intercept,ACTIVITY_Intercept)             0.58 1.00    11471
cor(BODYMASS_SELECTIONPoly,ACTIVITY_Intercept)         0.60 1.00     9828
cor(VO2_Intercept,ACTIVITY_SELECTIONPoly)              0.66 1.00    18961
cor(VO2_SELECTIONPoly,ACTIVITY_SELECTIONPoly)          0.67 1.00    15304
cor(VCO2_RQ_Intercept,ACTIVITY_SELECTIONPoly)          0.64 1.00    16071
cor(VCO2_RQ_SELECTIONPoly,ACTIVITY_SELECTIONPoly)      0.63 1.00    11815
cor(BODYMASS_Intercept,ACTIVITY_SELECTIONPoly)         0.58 1.00    11813
cor(BODYMASS_SELECTIONPoly,ACTIVITY_SELECTIONPoly)     0.59 1.00     8694
cor(ACTIVITY_Intercept,ACTIVITY_SELECTIONPoly)         0.64 1.00     9306
                                                   Tail_ESS
sd(VO2_Intercept)                                      7298
sd(VO2_SELECTIONPoly)                                  7871
sd(VCO2_RQ_Intercept)                                  7044
sd(VCO2_RQ_SELECTIONPoly)                              8839
sd(BODYMASS_Intercept)                                 7352
sd(BODYMASS_SELECTIONPoly)                             8496
sd(ACTIVITY_Intercept)                                 8016
sd(ACTIVITY_SELECTIONPoly)                             6315
cor(VO2_Intercept,VO2_SELECTIONPoly)                   9696
cor(VO2_Intercept,VCO2_RQ_Intercept)                  10724
cor(VO2_SELECTIONPoly,VCO2_RQ_Intercept)              11086
cor(VO2_Intercept,VCO2_RQ_SELECTIONPoly)              10005
cor(VO2_SELECTIONPoly,VCO2_RQ_SELECTIONPoly)          10169
cor(VCO2_RQ_Intercept,VCO2_RQ_SELECTIONPoly)          10637
cor(VO2_Intercept,BODYMASS_Intercept)                 10714
cor(VO2_SELECTIONPoly,BODYMASS_Intercept)             11052
cor(VCO2_RQ_Intercept,BODYMASS_Intercept)             10991
cor(VCO2_RQ_SELECTIONPoly,BODYMASS_Intercept)         11398
cor(VO2_Intercept,BODYMASS_SELECTIONPoly)              9962
cor(VO2_SELECTIONPoly,BODYMASS_SELECTIONPoly)         10667
cor(VCO2_RQ_Intercept,BODYMASS_SELECTIONPoly)         10833
cor(VCO2_RQ_SELECTIONPoly,BODYMASS_SELECTIONPoly)     11096
cor(BODYMASS_Intercept,BODYMASS_SELECTIONPoly)        11687
cor(VO2_Intercept,ACTIVITY_Intercept)                 10349
cor(VO2_SELECTIONPoly,ACTIVITY_Intercept)             11057
cor(VCO2_RQ_Intercept,ACTIVITY_Intercept)             11037
cor(VCO2_RQ_SELECTIONPoly,ACTIVITY_Intercept)         10866
cor(BODYMASS_Intercept,ACTIVITY_Intercept)            11942
cor(BODYMASS_SELECTIONPoly,ACTIVITY_Intercept)        11517
cor(VO2_Intercept,ACTIVITY_SELECTIONPoly)             10405
cor(VO2_SELECTIONPoly,ACTIVITY_SELECTIONPoly)         10555
cor(VCO2_RQ_Intercept,ACTIVITY_SELECTIONPoly)         11436
cor(VCO2_RQ_SELECTIONPoly,ACTIVITY_SELECTIONPoly)     11866
cor(BODYMASS_Intercept,ACTIVITY_SELECTIONPoly)        12454
cor(BODYMASS_SELECTIONPoly,ACTIVITY_SELECTIONPoly)    10643
cor(ACTIVITY_Intercept,ACTIVITY_SELECTIONPoly)        11230

~SAMPLE (Number of levels: 48) 
                       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(VO2_Intercept)          0.98      0.17     0.66     1.33 1.00     4002
sd(VCO2_RQ_Intercept)      0.43      0.27     0.01     0.96 1.00     1393
sd(ACTIVITY_Intercept)     0.59      0.08     0.44     0.77 1.00     5220
                       Tail_ESS
sd(VO2_Intercept)          6816
sd(VCO2_RQ_Intercept)      5816
sd(ACTIVITY_Intercept)     8622

Population-Level Effects: 
                                     Estimate Est.Error l-95% CI u-95% CI Rhat
VO2_Intercept                            8.05      0.41     7.23     8.85 1.00
BODYMASS_Intercept                       0.35      0.25    -0.15     0.85 1.00
ACTIVITY_Intercept                      -0.78      0.22    -1.21    -0.34 1.00
VO2_SELECTIONPoly                       -0.14      0.52    -1.13     0.90 1.00
VO2_SEXM                                -1.01      0.49    -1.97    -0.05 1.00
VO2_CYCLEII                             -1.10      0.34    -1.75    -0.43 1.00
VO2_CYCLEIII                            -1.73      0.33    -2.36    -1.07 1.00
VO2_BODYMASS                             0.30      0.24    -0.16     0.77 1.00
VO2_ACTIVITY                             1.01      0.17     0.68     1.33 1.00
VO2_SELECTIONPoly:SEXM                   0.65      0.56    -0.47     1.74 1.00
VO2_SELECTIONPoly:CYCLEII                0.31      0.44    -0.56     1.18 1.00
VO2_SELECTIONPoly:CYCLEIII              -0.14      0.43    -0.97     0.72 1.00
VO2_SEXM:CYCLEII                         0.15      0.44    -0.72     1.01 1.00
VO2_SEXM:CYCLEIII                       -0.51      0.44    -1.38     0.37 1.00
VO2_SELECTIONPoly:SEXM:CYCLEII          -0.16      0.56    -1.27     0.94 1.00
VO2_SELECTIONPoly:SEXM:CYCLEIII          0.51      0.56    -0.59     1.61 1.00
VCO2_RQ_Intercept                       -0.01      0.32    -0.62     0.64 1.00
VCO2_RQ_SELECTIONPoly                    0.30      0.45    -0.59     1.18 1.00
VCO2_RQ_SEXM                             0.48      0.43    -0.36     1.34 1.00
VCO2_RQ_CYCLEII                          0.39      0.38    -0.34     1.16 1.00
VCO2_RQ_CYCLEIII                        -0.11      0.38    -0.85     0.65 1.00
VCO2_RQ_BODYMASS                        -0.01      0.18    -0.37     0.35 1.00
VCO2_RQ_ACTIVITY                        -0.22      0.16    -0.53     0.08 1.00
VCO2_RQ_SELECTIONPoly:SEXM               0.13      0.50    -0.87     1.10 1.00
VCO2_RQ_SELECTIONPoly:CYCLEII            0.03      0.46    -0.88     0.92 1.00
VCO2_RQ_SELECTIONPoly:CYCLEIII           0.57      0.48    -0.37     1.52 1.00
VCO2_RQ_SEXM:CYCLEII                    -0.53      0.52    -1.55     0.50 1.00
VCO2_RQ_SEXM:CYCLEIII                   -0.03      0.57    -1.16     1.10 1.00
VCO2_RQ_SELECTIONPoly:SEXM:CYCLEII      -0.47      0.61    -1.67     0.72 1.00
VCO2_RQ_SELECTIONPoly:SEXM:CYCLEIII     -0.81      0.65    -2.08     0.47 1.00
BODYMASS_SELECTIONPoly                   0.53      0.38    -0.23     1.25 1.00
BODYMASS_SEXM                           -1.02      0.26    -1.52    -0.51 1.00
BODYMASS_SELECTIONPoly:SEXM             -0.44      0.35    -1.14     0.26 1.00
ACTIVITY_SELECTIONPoly                   1.05      0.32     0.42     1.67 1.00
ACTIVITY_SEXM                            0.46      0.28    -0.10     1.01 1.00
ACTIVITY_CYCLEII                         0.19      0.19    -0.17     0.56 1.00
ACTIVITY_CYCLEIII                        0.24      0.19    -0.13     0.61 1.00
ACTIVITY_SELECTIONPoly:SEXM             -0.06      0.38    -0.81     0.69 1.00
ACTIVITY_SELECTIONPoly:CYCLEII           0.10      0.26    -0.40     0.62 1.00
ACTIVITY_SELECTIONPoly:CYCLEIII         -0.01      0.26    -0.51     0.50 1.00
ACTIVITY_SEXM:CYCLEII                   -0.48      0.26    -0.99     0.03 1.00
ACTIVITY_SEXM:CYCLEIII                  -0.68      0.26    -1.18    -0.16 1.00
ACTIVITY_SELECTIONPoly:SEXM:CYCLEII      0.32      0.35    -0.36     1.01 1.00
ACTIVITY_SELECTIONPoly:SEXM:CYCLEIII     0.52      0.35    -0.17     1.20 1.00
                                     Bulk_ESS Tail_ESS
VO2_Intercept                           10865    10859
BODYMASS_Intercept                      13100    10547
ACTIVITY_Intercept                       6658     9540
VO2_SELECTIONPoly                       10472    10634
VO2_SEXM                                 9872    10738
VO2_CYCLEII                             12285    11112
VO2_CYCLEIII                            12683    11855
VO2_BODYMASS                             8712    10373
VO2_ACTIVITY                            13529    11699
VO2_SELECTIONPoly:SEXM                  10718    11449
VO2_SELECTIONPoly:CYCLEII               13244    11467
VO2_SELECTIONPoly:CYCLEIII              13745    11369
VO2_SEXM:CYCLEII                        12860    11611
VO2_SEXM:CYCLEIII                       13469    11323
VO2_SELECTIONPoly:SEXM:CYCLEII          13443    11260
VO2_SELECTIONPoly:SEXM:CYCLEIII         14809    11546
VCO2_RQ_Intercept                        9550     9908
VCO2_RQ_SELECTIONPoly                   10808    10216
VCO2_RQ_SEXM                            11827     9973
VCO2_RQ_CYCLEII                         13056    11478
VCO2_RQ_CYCLEIII                        15659    10534
VCO2_RQ_BODYMASS                        14791    10512
VCO2_RQ_ACTIVITY                        12520    10790
VCO2_RQ_SELECTIONPoly:SEXM              10981     9932
VCO2_RQ_SELECTIONPoly:CYCLEII           14363    11092
VCO2_RQ_SELECTIONPoly:CYCLEIII          15735    11289
VCO2_RQ_SEXM:CYCLEII                    14453    10864
VCO2_RQ_SEXM:CYCLEIII                   16138    10720
VCO2_RQ_SELECTIONPoly:SEXM:CYCLEII      14530    11474
VCO2_RQ_SELECTIONPoly:SEXM:CYCLEIII     16955    11436
BODYMASS_SELECTIONPoly                  11857     9350
BODYMASS_SEXM                           16890    11227
BODYMASS_SELECTIONPoly:SEXM             16059    11830
ACTIVITY_SELECTIONPoly                   6931     8611
ACTIVITY_SEXM                            6252     8821
ACTIVITY_CYCLEII                         9521    10787
ACTIVITY_CYCLEIII                       10125    10986
ACTIVITY_SELECTIONPoly:SEXM              6210     8484
ACTIVITY_SELECTIONPoly:CYCLEII           9959    10838
ACTIVITY_SELECTIONPoly:CYCLEIII          9679    10904
ACTIVITY_SEXM:CYCLEII                    9607    10278
ACTIVITY_SEXM:CYCLEIII                   9895    10829
ACTIVITY_SELECTIONPoly:SEXM:CYCLEII      9988    10625
ACTIVITY_SELECTIONPoly:SEXM:CYCLEIII    10007    10709

Family Specific Parameters: 
               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_VO2          1.05      0.08     0.90     1.21 1.00     9932    10658
sigma_VCO2         0.55      0.05     0.47     0.65 1.00     3333     8438
sigma_BODYMASS     0.68      0.09     0.54     0.87 1.00    12230     8747
sigma_ACTIVITY     0.50      0.04     0.43     0.58 1.00    10334    11254

Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).
</pre>
</div>
</div>
<div id="posterior-estimates-of-the-effect-size" class="section level2">
<h2>Posterior estimates of the effect size</h2>
<p>Here, we calculate the effect size of the selection treatment on each response variable (and <code>RQ</code>) from the posterior estimates of the SEM.</p>
<div id="derive-posterior-predictions-of-group-means" class="section level3">
<h3>Derive posterior predictions of group means</h3>
<p>Here, we use the model to predict the means for each response variable (and the parameter <code>RQ</code>) in each treatment, sex and cycle (averaged across the eight replicate selection lines).</p>
<p>Because the model contains body mass and activity level as mediator variables, we derived the posterior predictions in three different ways, and display the answer for all three in the following figures/tables.</p>
<p>Firstly, we predicted the posterior means without controlling for either of the mediator variables, by deriving our predictions for each cycle, sex, and treatment with <code>BODYMASS</code> and <code>ACTIVITY</code> set to their estimated mean values for that specific cycle/sex/treatment combination. This means that (for example) if activity level positively affects respiration, and P flies evolved higher activity levels, we would predict higher VO2 in P flies due to their larger activity levels.</p>
<p>Secondly, we predicted the posterior means while controlling for differences in activity level between cycles, sexes, and treatments. This was accomplished by producing the posterior predictions with <code>ACTIVITY</code> set to its global mean value (i.e. 0), which is equivalent to asking what the response variables would be if activity levels were the same across cycles, sexes, and treatments.</p>
<p>Thirdly, we predicted the posterior means while controlling for differences in body mass between sexes and treatment. This was accomplished by producing the posterior predictions with <code>BODYMASS</code> set to its global mean value (i.e. 0), which is equivalent to asking what the response variables would be if body mass were the same across sexes and treatments.</p>
<pre class="r"><code>new &lt;- scaled_data %&gt;%
  select(SELECTION, SEX, CYCLE) %&gt;%
  distinct() %&gt;%
  mutate(body_subset = TRUE)

# Find the posterior estimates of the means for the mediator variables:
bodymass_posterior &lt;- brms_SEM_respiration %&gt;%
  fitted(newdata = new, re_formula = NA,
         resp = &quot;BODYMASS&quot;, summary = FALSE) %&gt;% 
  reshape2::melt() %&gt;%
  rename(draw = Var1, parameter_space = Var2, `Body mass` = value) %&gt;%
  left_join(new %&gt;% mutate(parameter_space = 1:n()), by = &quot;parameter_space&quot;) %&gt;%
  select(draw, SELECTION, SEX, `Body mass`) %&gt;% as_tibble() %&gt;% distinct() %&gt;%
  mutate(
    treat = ifelse(SELECTION == &quot;Mono&quot;, &quot;M&quot;, &quot;P&quot;), 
    sex = ifelse(SEX == &quot;F&quot;, &quot;females&quot;, &quot;males&quot;), 
    sextreat = paste(treat, sex),
    SEX = factor(ifelse(SEX == &quot;F&quot;, &quot;Females&quot;, &quot;Males&quot;), c(&quot;Males&quot;, &quot;Females&quot;)),
    SELECTION = ifelse(SELECTION == &quot;Poly&quot;, &quot;Polyandry&quot;, &quot;Monandry&quot;)) 

activity_posterior &lt;- brms_SEM_respiration %&gt;%
  fitted(newdata = new, re_formula = NA,
         resp = &quot;ACTIVITY&quot;, summary = FALSE) %&gt;% 
  reshape2::melt() %&gt;%
  rename(draw = Var1, parameter_space = Var2, `Activity level` = value) %&gt;%
  left_join(new %&gt;% mutate(parameter_space = 1:n()), by = &quot;parameter_space&quot;) %&gt;%
  select(draw, SELECTION, SEX, CYCLE, `Activity level`) %&gt;% as_tibble() %&gt;%
  mutate(
    treat = ifelse(SELECTION == &quot;Mono&quot;, &quot;M&quot;, &quot;P&quot;), 
    sex = ifelse(SEX == &quot;F&quot;, &quot;females&quot;, &quot;males&quot;), 
    sextreat = paste(treat, sex),
    SEX = factor(ifelse(SEX == &quot;F&quot;, &quot;Females&quot;, &quot;Males&quot;), c(&quot;Males&quot;, &quot;Females&quot;)),
    SELECTION = ifelse(SELECTION == &quot;Poly&quot;, &quot;Polyandry&quot;, &quot;Monandry&quot;)) 


# Get the median posterior estimate of body weight and activity,
# for the 4 combinations of sex and monogamy/polyandry treatment (and 3 cycles, for activity)
bodymass &lt;- brms_SEM_respiration %&gt;%
  fitted(newdata = new, re_formula = NA,
         resp = &quot;BODYMASS&quot;) %&gt;% as_tibble()

activity &lt;- brms_SEM_respiration %&gt;%
  fitted(newdata = new, re_formula = NA,
         resp = &quot;ACTIVITY&quot;) %&gt;% as_tibble()

new_mediators &lt;- new %&gt;%
  mutate(BODYMASS = bodymass$Estimate,
         ACTIVITY = activity$Estimate)

new_complete &lt;- bind_rows(
  new_mediators %&gt;% mutate(mediators_blocked = &quot;Neither&quot;),
  new_mediators %&gt;% mutate(mediators_blocked = &quot;Activity&quot;, 
                 ACTIVITY = 0),
  new_mediators %&gt;% mutate(mediators_blocked = &quot;Body mass&quot;,
                 BODYMASS = 0)) %&gt;%
  mutate(VO2 = NA, parameter_space = 1:n()) 

post_preds_respiration &lt;- left_join(
  brms_SEM_respiration %&gt;%
    fitted(newdata = new_complete, re_formula = NA,
           resp = &quot;VO2&quot;, summary = FALSE) %&gt;% reshape2::melt() %&gt;% 
    rename(draw = Var1, parameter_space = Var2, VO2 = value) %&gt;%
    left_join(new_complete %&gt;% select(-VO2), by = &quot;parameter_space&quot;) %&gt;% 
    as_tibble(),
  
  brms_SEM_respiration %&gt;%
    fitted(newdata = new_complete, re_formula = NA,
           resp = &quot;VCO2&quot;, nlpar = &quot;RQ&quot;, summary = FALSE) %&gt;% reshape2::melt() %&gt;% 
    rename(draw = Var1, parameter_space = Var2, RQ = value) %&gt;%
    left_join(new_complete %&gt;% select(-VO2), by = &quot;parameter_space&quot;) %&gt;% 
    as_tibble() %&gt;%
    mutate(RQ = 0.7 + 0.3 * inv_logit(RQ)), 
  by = c(&quot;draw&quot;, &quot;parameter_space&quot;, &quot;SELECTION&quot;, &quot;SEX&quot;, &quot;CYCLE&quot;, 
         &quot;body_subset&quot;, &quot;BODYMASS&quot;, &quot;ACTIVITY&quot;, &quot;mediators_blocked&quot;)
) %&gt;% select(draw, VO2, RQ, SELECTION, SEX, CYCLE, mediators_blocked)</code></pre>
</div>
<div id="find-posterior-estimates-of-effect-size" class="section level3 tabset">
<h3>Find posterior estimates of effect size</h3>
<p>We then calculate the effect size of treatment by subtracting the (sex-specific) mean for the M treatment from the mean for the P treatment; thus a value of 1 would mean that the P treatment has a mean that is larger by 1 standard deviation. Thus, the y-axis in the following graphs essentially shows the posterior estimate of standardised effect size (Cohen’s d), from the model shown above.</p>
<pre class="r"><code>overall_SD_VO2 &lt;- scaled_data$VO2 %&gt;% sd()
overall_SD_RQ &lt;- respiration$RQ %&gt;% sd()

posterior_effect_size &lt;- post_preds_respiration %&gt;%
  mutate(mediators_blocked = factor(mediators_blocked, c(&quot;Neither&quot;, &quot;Body mass&quot;, &quot;Activity&quot;))) %&gt;%
  mutate(SEX = factor(ifelse(SEX == &quot;M&quot;, &quot;Males&quot;, &quot;Females&quot;), c(&quot;Males&quot;, &quot;Females&quot;))) %&gt;%
  mutate(CYCLE = paste(&quot;Cycle&quot;, CYCLE)) %&gt;%
  group_by(draw, SEX, CYCLE, mediators_blocked) %&gt;%
  summarise(VO2_effect = (VO2[SELECTION == &quot;Poly&quot;] - VO2[SELECTION == &quot;Mono&quot;]) / overall_SD_VO2,
            RQ_effect = (RQ[SELECTION == &quot;Poly&quot;] - RQ[SELECTION == &quot;Mono&quot;]) / overall_SD_RQ,
            .groups = &quot;drop&quot;) </code></pre>
<div id="figure" class="section level4">
<h4>Figure</h4>
<p>Note that the females are larger than males, and that P females are somewhat larger than M females. P individuals of both sexes are more active than M individuals, and there are changes in activity level across cycles (in particular, M males become less active with time, while P males maintain consistent, high activity levels).</p>
<pre class="r"><code>p1 &lt;- arrangeGrob(
  
  bodymass_posterior %&gt;%
    mutate(CYCLE = &quot;All cycles&quot;) %&gt;%
    ggplot(aes(y = SELECTION, x = `Body mass`, fill = sextreat)) + 
    geom_vline(xintercept = 0, linetype = 2, colour = &quot;grey20&quot;) + 
    geom_halfeyeh(alpha = 0.7, size = 0.6) +
    facet_grid(SEX ~ CYCLE) +
    coord_cartesian(xlim = c(-1.9, 1.9)) + 
    scale_fill_manual(values = cols, name = &quot;&quot;) + 
    theme_bw() + 
    theme(legend.position = &quot;none&quot;,
          strip.text.y = element_text(colour = &quot;white&quot;),
          text = element_text(family = nice_font),
          strip.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;)) + 
    ylab(NULL),
  
  activity_posterior %&gt;%
    mutate(CYCLE = paste(&quot;Cycle&quot;, CYCLE)) %&gt;%
    ggplot(aes(y = SELECTION, x = `Activity level`, fill = sextreat)) + 
    geom_vline(xintercept = 0, linetype = 2, colour = &quot;grey20&quot;) + 
    stat_halfeyeh(alpha = 0.7, size = 0.6) + 
    facet_grid(SEX ~ CYCLE) +
    scale_fill_manual(values = cols, name = &quot;&quot;) + 
    theme_bw() + 
    coord_cartesian(xlim = c(-1.5, 1.7)) + 
    theme(legend.position = &quot;none&quot;, 
          axis.text.y = element_blank(), 
          text = element_text(family = nice_font),
          strip.background = element_blank(),
          axis.ticks.y = element_blank()) + ylab(NULL),
  nrow = 1, widths = c(0.38, 0.62), 
  left = textGrob(&quot;Selection treatment&quot;, rot = 90, gp=gpar(fontfamily = nice_font)),
  top = textGrob(&quot;A. Mediator variables (means)&quot;, hjust = 1, gp=gpar(fontfamily = nice_font)) 
)

p2 &lt;- arrangeGrob(
  posterior_effect_size %&gt;% 
    ggplot(aes(y = mediators_blocked, 
               x = VO2_effect,
               fill = mediators_blocked)) + 
    geom_vline(xintercept = 0, linetype = 2) + 
    stat_halfeyeh(size = 0.5, alpha = 0.5) + 
    facet_grid(SEX ~ CYCLE) +
    xlab(expression(VO[2]~(P~-~M))) + 
    ylab(NULL)  +
    scale_fill_brewer(palette = &quot;Set2&quot;) + 
    theme_bw() +
    coord_cartesian(xlim = c(-0.6, 1.9)) + 
    theme(legend.position = &quot;none&quot;,
          text = element_text(family = nice_font),
          strip.background = element_blank()),
  
  posterior_effect_size %&gt;% 
    ggplot(aes(y = mediators_blocked, 
               x = RQ_effect,
               fill = mediators_blocked)) + 
    geom_vline(xintercept = 0, linetype = 2) + 
    stat_halfeyeh(size = 0.5, alpha = 0.5) + 
    facet_grid(SEX ~ CYCLE) +
    xlab(&quot;RQ (P - M)&quot;) + 
    ylab(NULL)  +
    scale_fill_brewer(palette = &quot;Set2&quot;) + 
    theme_bw() +
    scale_x_continuous(breaks = c(-1, 0, 1)) +
    coord_cartesian(xlim = c(-1.1, 1.5)) + 
    theme(legend.position = &quot;none&quot;,
          text = element_text(family = nice_font),
          strip.background = element_blank()),
  ncol = 1, 
  left = textGrob(&quot;Mediator variables controlled for&quot;, rot = 90, gp=gpar(fontfamily = nice_font)),
  top = textGrob(&quot;B. Respiration (effect sizes)&quot;, hjust = 1, gp=gpar(fontfamily = nice_font)) 
)

p_filler &lt;- ggplot() + theme_void()

grid.arrange(p1, 
             arrangeGrob(p_filler, p2, p_filler, 
                         nrow = 1, widths = c(0.1, 0.8, 0.1)), 
             heights = c(0.35, 0.65)) %&gt;%
  ggsave(&quot;figures/respiration_figure.pdf&quot;, plot = ., height = 8, width = 5)

grid.arrange(p1, 
             arrangeGrob(p_filler, p2, p_filler, 
                         nrow = 1, widths = c(0.1, 0.8, 0.1)), 
             heights = c(0.35, 0.65)) </code></pre>
<p><img src="figure/respirometry.Rmd/unnamed-chunk-19-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-19-1">
Past versions of unnamed-chunk-19-1.png
</button>
</p>
<div id="fig-unnamed-chunk-19-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/4b2ed7018d65ad5855bb0ca0773819b5b074e964/docs/figure/respirometry.Rmd/unnamed-chunk-19-1.png" target="_blank">4b2ed70</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/2791e70bfba58cbb5318dbbb6a52cb0c9bbccdef/docs/figure/respirometry.Rmd/unnamed-chunk-19-1.png" target="_blank">2791e70</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tables" class="section level4">
<h4>Tables</h4>
<div id="posterior-estimates-of-the-mean-for-mediator-variables" class="section level5">
<h5>Posterior estimates of the mean for mediator variables</h5>
<pre class="r"><code>bodymass_posterior %&gt;%
  mutate(CYCLE = &quot;All cycles&quot;) %&gt;%
  select(SELECTION, SEX, CYCLE, `Body mass`, draw) %&gt;% 
  group_by(SELECTION, SEX, CYCLE) %&gt;%
  summarise(x = list(posterior_summary(`Body mass`) %&gt;% 
                        as.data.frame()), .groups = &quot;drop&quot;) %&gt;%
  unnest(x) %&gt;% mutate(Response = &quot;Body weight (mean)&quot;) %&gt;%
  bind_rows(
activity_posterior %&gt;%
  select(SELECTION, SEX, CYCLE, `Activity level`, draw) %&gt;%
  group_by(SELECTION, SEX, CYCLE) %&gt;%
  summarise(x = list(posterior_summary(`Activity level`) %&gt;% 
                        as.data.frame()), .groups = &quot;drop&quot;) %&gt;%
  unnest(x) %&gt;% mutate(Response = &quot;Activity level (mean)&quot;)) %&gt;%
  rename(Selection = SELECTION, Sex = SEX, Cycle = CYCLE) %&gt;%
  select(-Response) %&gt;%
  kable(digits = 3) %&gt;%
  kable_styling(full_width = FALSE) %&gt;%
  pack_rows(&quot;Body weight (mean)&quot;, 1, 4) %&gt;%
  pack_rows(&quot;Activity level (mean)&quot;, 5, 16)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Selection
</th>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:left;">
Cycle
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Est.Error
</th>
<th style="text-align:right;">
Q2.5
</th>
<th style="text-align:right;">
Q97.5
</th>
</tr>
</thead>
<tbody>
<tr grouplength="4">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>Body weight (mean)</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Monandry
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
All cycles
</td>
<td style="text-align:right;">
-0.671
</td>
<td style="text-align:right;">
0.255
</td>
<td style="text-align:right;">
-1.174
</td>
<td style="text-align:right;">
-0.155
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Monandry
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
All cycles
</td>
<td style="text-align:right;">
0.348
</td>
<td style="text-align:right;">
0.250
</td>
<td style="text-align:right;">
-0.145
</td>
<td style="text-align:right;">
0.846
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Polyandry
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
All cycles
</td>
<td style="text-align:right;">
-0.589
</td>
<td style="text-align:right;">
0.318
</td>
<td style="text-align:right;">
-1.249
</td>
<td style="text-align:right;">
0.016
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Polyandry
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
All cycles
</td>
<td style="text-align:right;">
0.873
</td>
<td style="text-align:right;">
0.308
</td>
<td style="text-align:right;">
0.236
</td>
<td style="text-align:right;">
1.458
</td>
</tr>
<tr grouplength="12">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>Activity level (mean)</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Monandry
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
-0.323
</td>
<td style="text-align:right;">
0.227
</td>
<td style="text-align:right;">
-0.768
</td>
<td style="text-align:right;">
0.119
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Monandry
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
-0.610
</td>
<td style="text-align:right;">
0.231
</td>
<td style="text-align:right;">
-1.061
</td>
<td style="text-align:right;">
-0.164
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Monandry
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
-0.761
</td>
<td style="text-align:right;">
0.231
</td>
<td style="text-align:right;">
-1.215
</td>
<td style="text-align:right;">
-0.305
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Monandry
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
-0.780
</td>
<td style="text-align:right;">
0.218
</td>
<td style="text-align:right;">
-1.210
</td>
<td style="text-align:right;">
-0.339
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Monandry
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
-0.588
</td>
<td style="text-align:right;">
0.226
</td>
<td style="text-align:right;">
-1.029
</td>
<td style="text-align:right;">
-0.135
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Monandry
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
-0.542
</td>
<td style="text-align:right;">
0.228
</td>
<td style="text-align:right;">
-0.986
</td>
<td style="text-align:right;">
-0.089
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Polyandry
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
0.659
</td>
<td style="text-align:right;">
0.264
</td>
<td style="text-align:right;">
0.126
</td>
<td style="text-align:right;">
1.165
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Polyandry
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
0.800
</td>
<td style="text-align:right;">
0.269
</td>
<td style="text-align:right;">
0.264
</td>
<td style="text-align:right;">
1.318
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Polyandry
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
0.728
</td>
<td style="text-align:right;">
0.270
</td>
<td style="text-align:right;">
0.190
</td>
<td style="text-align:right;">
1.243
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Polyandry
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
0.266
</td>
<td style="text-align:right;">
0.257
</td>
<td style="text-align:right;">
-0.237
</td>
<td style="text-align:right;">
0.756
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Polyandry
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
II
</td>
<td style="text-align:right;">
0.562
</td>
<td style="text-align:right;">
0.266
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
1.077
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Polyandry
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
III
</td>
<td style="text-align:right;">
0.492
</td>
<td style="text-align:right;">
0.266
</td>
<td style="text-align:right;">
-0.037
</td>
<td style="text-align:right;">
1.010
</td>
</tr>
</tbody>
</table>
</div>
<div id="posterior-estimates-of-the-effect-size-for-vo_2-and-rq" class="section level5">
<h5>Posterior estimates of the effect size for VO<span class="math inline">\(_2\)</span> and RQ</h5>
<pre class="r"><code>posterior_effect_size %&gt;%
  select(mediators_blocked, SEX, CYCLE, VO2_effect, draw) %&gt;%
  group_by(mediators_blocked, SEX, CYCLE) %&gt;%
  summarise(x = list(posterior_summary(VO2_effect) %&gt;% 
                        as.data.frame()),
            p = 1 - as.numeric(bayestestR::p_direction(VO2_effect)),
            ` ` = ifelse(p &lt; 0.05, &quot;\\*&quot;, &quot;&quot;),
            .groups = &quot;drop&quot;) %&gt;%
  unnest(x) %&gt;% mutate(Response = &quot;VO2 effect size&quot;) %&gt;%
  bind_rows(
    posterior_effect_size %&gt;%
      select(mediators_blocked, SEX, CYCLE, RQ_effect, draw) %&gt;%
      group_by(mediators_blocked, SEX, CYCLE) %&gt;%
       summarise(x = list(posterior_summary(RQ_effect) %&gt;% 
                        as.data.frame()),
            p = 1 - as.numeric(bayestestR::p_direction(RQ_effect)),
            ` ` = ifelse(p &lt; 0.05, &quot;\\*&quot;, &quot;&quot;),
            .groups = &quot;drop&quot;) %&gt;%
      unnest(x) %&gt;% mutate(Response = &quot;RQ effect size&quot;)) %&gt;%
  select(-Response) %&gt;% rename(`Mediators blocked` = mediators_blocked, Sex = SEX, Cycle = CYCLE) %&gt;%
  kable(digits = 3) %&gt;%
  kable_styling(full_width = FALSE) %&gt;%
  pack_rows(&quot;VO2 effect size&quot;, 1, 18) %&gt;%
  pack_rows(&quot;RQ effect size&quot;, 19, 36)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Mediators blocked
</th>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:left;">
Cycle
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Est.Error
</th>
<th style="text-align:right;">
Q2.5
</th>
<th style="text-align:right;">
Q97.5
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr grouplength="18">
<td colspan="9" style="border-bottom: 1px solid;">
<strong>VO2 effect size</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.714
</td>
<td style="text-align:right;">
0.267
</td>
<td style="text-align:right;">
0.185
</td>
<td style="text-align:right;">
1.235
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
0.987
</td>
<td style="text-align:right;">
0.285
</td>
<td style="text-align:right;">
0.425
</td>
<td style="text-align:right;">
1.547
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
1.132
</td>
<td style="text-align:right;">
0.284
</td>
<td style="text-align:right;">
0.569
</td>
<td style="text-align:right;">
1.688
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.504
</td>
<td style="text-align:right;">
0.234
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.970
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
0.698
</td>
<td style="text-align:right;">
0.268
</td>
<td style="text-align:right;">
0.172
</td>
<td style="text-align:right;">
1.222
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
0.434
</td>
<td style="text-align:right;">
0.265
</td>
<td style="text-align:right;">
-0.080
</td>
<td style="text-align:right;">
0.959
</td>
<td style="text-align:right;">
0.050
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.703
</td>
<td style="text-align:right;">
0.267
</td>
<td style="text-align:right;">
0.175
</td>
<td style="text-align:right;">
1.221
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
0.976
</td>
<td style="text-align:right;">
0.285
</td>
<td style="text-align:right;">
0.413
</td>
<td style="text-align:right;">
1.534
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
1.121
</td>
<td style="text-align:right;">
0.284
</td>
<td style="text-align:right;">
0.558
</td>
<td style="text-align:right;">
1.675
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.430
</td>
<td style="text-align:right;">
0.237
</td>
<td style="text-align:right;">
-0.033
</td>
<td style="text-align:right;">
0.898
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
0.624
</td>
<td style="text-align:right;">
0.273
</td>
<td style="text-align:right;">
0.088
</td>
<td style="text-align:right;">
1.158
</td>
<td style="text-align:right;">
0.011
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
0.360
</td>
<td style="text-align:right;">
0.269
</td>
<td style="text-align:right;">
-0.164
</td>
<td style="text-align:right;">
0.888
</td>
<td style="text-align:right;">
0.088
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.250
</td>
<td style="text-align:right;">
0.278
</td>
<td style="text-align:right;">
-0.296
</td>
<td style="text-align:right;">
0.803
</td>
<td style="text-align:right;">
0.179
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
0.320
</td>
<td style="text-align:right;">
0.305
</td>
<td style="text-align:right;">
-0.283
</td>
<td style="text-align:right;">
0.923
</td>
<td style="text-align:right;">
0.144
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
0.428
</td>
<td style="text-align:right;">
0.306
</td>
<td style="text-align:right;">
-0.167
</td>
<td style="text-align:right;">
1.026
</td>
<td style="text-align:right;">
0.079
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.242
</td>
<td style="text-align:right;">
-0.457
</td>
<td style="text-align:right;">
0.493
</td>
<td style="text-align:right;">
0.492
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
0.154
</td>
<td style="text-align:right;">
0.281
</td>
<td style="text-align:right;">
-0.394
</td>
<td style="text-align:right;">
0.710
</td>
<td style="text-align:right;">
0.288
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
-0.055
</td>
<td style="text-align:right;">
0.277
</td>
<td style="text-align:right;">
-0.588
</td>
<td style="text-align:right;">
0.499
</td>
<td style="text-align:right;">
0.417
</td>
<td style="text-align:left;">
</td>
</tr>
<tr grouplength="18">
<td colspan="9" style="border-bottom: 1px solid;">
<strong>RQ effect size</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.117
</td>
<td style="text-align:right;">
0.278
</td>
<td style="text-align:right;">
-0.453
</td>
<td style="text-align:right;">
0.639
</td>
<td style="text-align:right;">
0.326
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
-0.189
</td>
<td style="text-align:right;">
0.346
</td>
<td style="text-align:right;">
-0.865
</td>
<td style="text-align:right;">
0.490
</td>
<td style="text-align:right;">
0.290
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
-0.077
</td>
<td style="text-align:right;">
0.390
</td>
<td style="text-align:right;">
-0.811
</td>
<td style="text-align:right;">
0.700
</td>
<td style="text-align:right;">
0.417
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
0.249
</td>
<td style="text-align:right;">
-0.463
</td>
<td style="text-align:right;">
0.523
</td>
<td style="text-align:right;">
0.444
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
0.037
</td>
<td style="text-align:right;">
0.287
</td>
<td style="text-align:right;">
-0.536
</td>
<td style="text-align:right;">
0.595
</td>
<td style="text-align:right;">
0.447
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Neither
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
0.373
</td>
<td style="text-align:right;">
0.310
</td>
<td style="text-align:right;">
-0.255
</td>
<td style="text-align:right;">
0.969
</td>
<td style="text-align:right;">
0.116
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.118
</td>
<td style="text-align:right;">
0.279
</td>
<td style="text-align:right;">
-0.454
</td>
<td style="text-align:right;">
0.645
</td>
<td style="text-align:right;">
0.326
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
-0.187
</td>
<td style="text-align:right;">
0.345
</td>
<td style="text-align:right;">
-0.863
</td>
<td style="text-align:right;">
0.490
</td>
<td style="text-align:right;">
0.289
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
-0.076
</td>
<td style="text-align:right;">
0.390
</td>
<td style="text-align:right;">
-0.810
</td>
<td style="text-align:right;">
0.699
</td>
<td style="text-align:right;">
0.418
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.038
</td>
<td style="text-align:right;">
0.252
</td>
<td style="text-align:right;">
-0.471
</td>
<td style="text-align:right;">
0.525
</td>
<td style="text-align:right;">
0.436
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
0.039
</td>
<td style="text-align:right;">
0.288
</td>
<td style="text-align:right;">
-0.543
</td>
<td style="text-align:right;">
0.601
</td>
<td style="text-align:right;">
0.446
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Body mass
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
0.374
</td>
<td style="text-align:right;">
0.312
</td>
<td style="text-align:right;">
-0.260
</td>
<td style="text-align:right;">
0.968
</td>
<td style="text-align:right;">
0.115
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.235
</td>
<td style="text-align:right;">
0.288
</td>
<td style="text-align:right;">
-0.353
</td>
<td style="text-align:right;">
0.779
</td>
<td style="text-align:right;">
0.202
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
-0.002
</td>
<td style="text-align:right;">
0.367
</td>
<td style="text-align:right;">
-0.728
</td>
<td style="text-align:right;">
0.698
</td>
<td style="text-align:right;">
0.498
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
0.113
</td>
<td style="text-align:right;">
0.411
</td>
<td style="text-align:right;">
-0.675
</td>
<td style="text-align:right;">
0.912
</td>
<td style="text-align:right;">
0.395
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:right;">
0.178
</td>
<td style="text-align:right;">
0.268
</td>
<td style="text-align:right;">
-0.355
</td>
<td style="text-align:right;">
0.695
</td>
<td style="text-align:right;">
0.250
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:right;">
0.183
</td>
<td style="text-align:right;">
0.309
</td>
<td style="text-align:right;">
-0.427
</td>
<td style="text-align:right;">
0.785
</td>
<td style="text-align:right;">
0.272
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
Activity
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:right;">
0.507
</td>
<td style="text-align:right;">
0.322
</td>
<td style="text-align:right;">
-0.157
</td>
<td style="text-align:right;">
1.110
</td>
<td style="text-align:right;">
0.062
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="posterior-difference-in-treatment-effect-size-between-sexes" class="section level2">
<h2>Posterior difference in treatment effect size between sexes</h2>
<p>This section essentially examines the treatment <span class="math inline">\(\times\)</span> sex interaction term, by calculating the difference in the effect size of the P/M treatment between sexes, for each cycle, for VO<span class="math inline">\(_2\)</span>. We find that the effect of the P/M treatment on VO<span class="math inline">\(_2\)</span> is greater in males than females, but only in the final cycle. Statistically correcting for differences in activity between sexes and treatments partly attenuated this effect, which suggests that the greater effect of treatment on activity in males is what explains the greater effect of treatment on VO2 in males.</p>
<div id="figure-1" class="section level3 tabset">
<h3>Figure</h3>
<pre class="r"><code>treatsex_interaction &lt;- posterior_effect_size %&gt;%
  rename(Cycle = CYCLE) %&gt;%
  group_by(draw, Cycle, mediators_blocked) %&gt;%
  summarise(`Difference in effect size between sexes (male - female)` = VO2_effect[1] - VO2_effect[2],
            .groups = &quot;drop&quot;)

treatsex_interaction %&gt;%
  ggplot(aes(x = `Difference in effect size between sexes (male - female)`, y = 1, fill = stat(x &lt; 0))) +
  geom_vline(xintercept = 0, linetype = 2) +
  stat_halfeyeh() +
  facet_grid(mediators_blocked ~ Cycle) +
  scale_fill_brewer(palette = &#39;Pastel2&#39;, direction = 1, name = &quot;&quot;) +
  theme_bw() +
  theme(legend.position = &#39;none&#39;,
        text = element_text(family = nice_font),
        strip.background = element_blank()) +
  ylab(&quot;Posterior density&quot;)</code></pre>
<p><img src="figure/respirometry.Rmd/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-22-1">
Past versions of unnamed-chunk-22-1.png
</button>
</p>
<div id="fig-unnamed-chunk-22-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/lukeholman/exp_evol_respiration/blob/d3f10f895f80892ee6c166fdd374d913c2c96427/docs/figure/respirometry.Rmd/unnamed-chunk-22-1.png" target="_blank">d3f10f8</a>
</td>
<td>
lukeholman
</td>
<td>
2020-12-18
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="table" class="section level3 tabset">
<h3>Table</h3>
<pre class="r"><code>treatsex_interaction %&gt;%
  rename(x = `Difference in effect size between sexes (male - female)`) %&gt;%
  group_by(Cycle, mediators_blocked) %&gt;%
  summarise(`Difference in effect size between sexes (male - female)` = median(x),
            `Lower 95% CI` = quantile(x, probs = 0.025), 
            `Upper 95% CI` = quantile(x, probs = 0.975),
            p = 1 - as.numeric(bayestestR::p_direction(x)),
            ` ` = ifelse(p &lt; 0.05, &quot;\\*&quot;, &quot;&quot;),
            .groups = &quot;drop&quot;) %&gt;%
  kable(digits=3) %&gt;%
  kable_styling(full_width = FALSE)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Cycle
</th>
<th style="text-align:left;">
mediators_blocked
</th>
<th style="text-align:right;">
Difference in effect size between sexes (male - female)
</th>
<th style="text-align:right;">
Lower 95% CI
</th>
<th style="text-align:right;">
Upper 95% CI
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:left;">
Neither
</td>
<td style="text-align:right;">
0.213
</td>
<td style="text-align:right;">
-0.314
</td>
<td style="text-align:right;">
0.714
</td>
<td style="text-align:right;">
0.209
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:left;">
Body mass
</td>
<td style="text-align:right;">
0.275
</td>
<td style="text-align:right;">
-0.255
</td>
<td style="text-align:right;">
0.784
</td>
<td style="text-align:right;">
0.151
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Cycle I
</td>
<td style="text-align:left;">
Activity
</td>
<td style="text-align:right;">
0.244
</td>
<td style="text-align:right;">
-0.284
</td>
<td style="text-align:right;">
0.745
</td>
<td style="text-align:right;">
0.177
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:left;">
Neither
</td>
<td style="text-align:right;">
0.295
</td>
<td style="text-align:right;">
-0.345
</td>
<td style="text-align:right;">
0.915
</td>
<td style="text-align:right;">
0.181
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:left;">
Body mass
</td>
<td style="text-align:right;">
0.360
</td>
<td style="text-align:right;">
-0.287
</td>
<td style="text-align:right;">
0.982
</td>
<td style="text-align:right;">
0.139
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Cycle II
</td>
<td style="text-align:left;">
Activity
</td>
<td style="text-align:right;">
0.174
</td>
<td style="text-align:right;">
-0.471
</td>
<td style="text-align:right;">
0.792
</td>
<td style="text-align:right;">
0.297
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:left;">
Neither
</td>
<td style="text-align:right;">
0.699
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
1.324
</td>
<td style="text-align:right;">
0.017
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:left;">
Body mass
</td>
<td style="text-align:right;">
0.764
</td>
<td style="text-align:right;">
0.110
</td>
<td style="text-align:right;">
1.392
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:left;">
*
</td>
</tr>
<tr>
<td style="text-align:left;">
Cycle III
</td>
<td style="text-align:left;">
Activity
</td>
<td style="text-align:right;">
0.485
</td>
<td style="text-align:right;">
-0.165
</td>
<td style="text-align:right;">
1.106
</td>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre>R version 4.0.3 (2020-10-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Catalina 10.15.4

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] knitrhooks_0.0.4   knitr_1.30         showtext_0.9-1     showtextdb_3.0    
 [5] sysfonts_0.8.2     DT_0.13            GGally_1.5.0       future.apply_1.5.0
 [9] future_1.17.0      ggridges_0.5.2     MuMIn_1.43.17      bayestestR_0.6.0  
[13] tidybayes_2.0.3    kableExtra_1.1.0   glue_1.4.2         RColorBrewer_1.1-2
[17] brms_2.14.4        Rcpp_1.0.4.6       gridExtra_2.3      forcats_0.5.0     
[21] stringr_1.4.0      dplyr_1.0.0        purrr_0.3.4        readr_1.3.1       
[25] tidyr_1.1.0        tibble_3.0.1       ggplot2_3.3.2      tidyverse_1.3.0   
[29] workflowr_1.6.2   

loaded via a namespace (and not attached):
  [1] readxl_1.3.1         backports_1.1.7      plyr_1.8.6          
  [4] igraph_1.2.5         svUnit_1.0.3         splines_4.0.3       
  [7] listenv_0.8.0        crosstalk_1.1.0.1    TH.data_1.0-10      
 [10] rstantools_2.1.1     inline_0.3.15        digest_0.6.25       
 [13] htmltools_0.5.0      rsconnect_0.8.16     fansi_0.4.1         
 [16] magrittr_2.0.1       globals_0.12.5       modelr_0.1.8        
 [19] RcppParallel_5.0.1   matrixStats_0.56.0   xts_0.12-0          
 [22] sandwich_2.5-1       prettyunits_1.1.1    colorspace_1.4-1    
 [25] blob_1.2.1           rvest_0.3.5          haven_2.3.1         
 [28] xfun_0.19            callr_3.4.3          crayon_1.3.4        
 [31] jsonlite_1.7.0       lme4_1.1-23          survival_3.2-7      
 [34] zoo_1.8-8            gtable_0.3.0         emmeans_1.4.7       
 [37] webshot_0.5.2        V8_3.4.0             pkgbuild_1.0.8      
 [40] rstan_2.21.2         abind_1.4-5          scales_1.1.1        
 [43] mvtnorm_1.1-0        DBI_1.1.0            miniUI_0.1.1.1      
 [46] viridisLite_0.3.0    xtable_1.8-4         stats4_4.0.3        
 [49] StanHeaders_2.21.0-3 htmlwidgets_1.5.1    httr_1.4.1          
 [52] DiagrammeR_1.0.6.1   threejs_0.3.3        arrayhelpers_1.1-0  
 [55] ellipsis_0.3.1       farver_2.0.3         reshape_0.8.8       
 [58] pkgconfig_2.0.3      loo_2.3.1            dbplyr_1.4.4        
 [61] labeling_0.3         tidyselect_1.1.0     rlang_0.4.6         
 [64] reshape2_1.4.4       later_1.0.0          visNetwork_2.0.9    
 [67] munsell_0.5.0        cellranger_1.1.0     tools_4.0.3         
 [70] cli_2.0.2            generics_0.0.2       broom_0.5.6         
 [73] evaluate_0.14        fastmap_1.0.1        yaml_2.2.1          
 [76] processx_3.4.2       fs_1.4.1             nlme_3.1-149        
 [79] whisker_0.4          mime_0.9             projpred_2.0.2      
 [82] xml2_1.3.2           compiler_4.0.3       bayesplot_1.7.2     
 [85] shinythemes_1.1.2    rstudioapi_0.11      gamm4_0.2-6         
 [88] curl_4.3             reprex_0.3.0         statmod_1.4.34      
 [91] stringi_1.5.3        highr_0.8            ps_1.3.3            
 [94] Brobdingnag_1.2-6    lattice_0.20-41      Matrix_1.2-18       
 [97] nloptr_1.2.2.1       markdown_1.1         shinyjs_1.1         
[100] vctrs_0.3.0          pillar_1.4.4         lifecycle_0.2.0     
[103] bridgesampling_1.0-0 estimability_1.3     insight_0.8.4       
[106] httpuv_1.5.3.1       R6_2.4.1             promises_1.1.0      
[109] codetools_0.2-16     boot_1.3-25          colourpicker_1.0    
[112] MASS_7.3-53          gtools_3.8.2         assertthat_0.2.1    
[115] rprojroot_1.3-2      withr_2.2.0          shinystan_2.5.0     
[118] multcomp_1.4-13      mgcv_1.8-33          parallel_4.0.3      
[121] hms_0.5.3            coda_0.19-3          minqa_1.2.4         
[124] rmarkdown_2.5        git2r_0.27.1         shiny_1.4.0.2       
[127] lubridate_1.7.8      base64enc_0.1-3      dygraphs_1.1.1.6    
</pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
